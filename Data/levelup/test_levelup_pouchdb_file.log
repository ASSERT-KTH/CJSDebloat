/data/js-variants/multee
16
pouchdb is testing ./Variants/levelup/variant16/levelup
/data/js-variants/multee
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 7s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink globally done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 414ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 4s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
Waiting for host to start ..
Host started :)
> pouchdb-monorepo@7.0.0-prerelease test-node
> bash bin/test-node.sh

Down server listening on port 3010
Seeded with: 1660147550143


  DB Setup
    ✓ PouchDB has a version
    ✓ PouchDB version matches package.json

  test.active_tasks.js
    ✓ Can add a task
    ✓ Can get tasks by id
    ✓ Can get all tasks
    ✓ Can update a task
    ✓ Can remove a task

  test.all_docs.js-http
    ✓ Testing all docs (143ms)
    ✓ Testing allDocs opts.keys (65ms)
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes (45ms)
    ✓ Testing updating in changes (47ms)
    ✓ Testing include docs
    ✓ Testing conflicts (54ms)
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria (147ms)
    ✓ test total_rows with both skip and limit
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option (39ms)
    ✓ test inclusive_end=false (59ms)
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (256ms)
    ✓ test empty db
    ✓ test after db close
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  test.all_docs.js-local
    ✓ Testing all docs
    ✓ Testing allDocs opts.keys (114ms)
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes
    ✓ Testing updating in changes
    ✓ Testing include docs
    ✓ Testing conflicts
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria
    ✓ test total_rows with both skip and limit
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (188ms)
    ✓ test empty db
    ✓ test after db close
    ✓ test unicode ids and revs
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  suite2 test.attachments.js-local
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes()
    ✓ #3074 live changes()
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (102ms)
    ✓ #2709 `revpos` with putAttachment
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js-http
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes() (43ms)
    ✓ #3074 live changes()
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs (38ms)
    ✓ #2771 allDocs() 7, revisions and deletions (50ms)
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments (59ms)
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs (39ms)
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback (43ms)
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs (47ms)
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc (41ms)
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data (42ms)
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev (39ms)
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs (47ms)
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction) (40ms)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (131ms)
    ✓ #2709 `revpos` with putAttachment (39ms)
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js- local:http
    ✓ Attachments replicate back and forth (110ms)
    ✓ Replicate same doc, same atts (150ms)
    ✓ Replicate same doc, same atts 2 (108ms)
    ✓ Attachments replicate (63ms)
    ✓ Attachment types replicate (62ms)
    ✓ Many many attachments replicate (191ms)
    ✓ Many many png attachments replicate (198ms)
    ✓ Multiple attachments replicate (81ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (83ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (71ms)
    ✓ #3932 attachments with tricky revpos (133ms)
    ✓ replication with changing attachments (102ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (124ms)

  suite2 test.attachments.js- http:http
    ✓ Attachments replicate back and forth (166ms)
    ✓ Replicate same doc, same atts (179ms)
    ✓ Replicate same doc, same atts 2 (220ms)
    ✓ Attachments replicate (79ms)
    ✓ Attachment types replicate (87ms)
    ✓ Many many attachments replicate (379ms)
    ✓ Many many png attachments replicate (290ms)
    ✓ Multiple attachments replicate (124ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (123ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (124ms)
    ✓ #3932 attachments with tricky revpos (344ms)
    ✓ replication with changing attachments (157ms)
    ✓ 3955 race condition in put (50ms)
    ✓ #8456 bad attachment rev after replication (169ms)

  suite2 test.attachments.js- http:local
    ✓ Attachments replicate back and forth (108ms)
    ✓ Replicate same doc, same atts (97ms)
    ✓ Replicate same doc, same atts 2 (110ms)
    ✓ Attachments replicate (67ms)
    ✓ Attachment types replicate (55ms)
    ✓ Many many attachments replicate (145ms)
    ✓ Many many png attachments replicate (158ms)
    ✓ Multiple attachments replicate (119ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (68ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (91ms)
    ✓ #3932 attachments with tricky revpos (144ms)
    ✓ replication with changing attachments (96ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (121ms)

  suite2 test.attachments.js- local:local
    ✓ Attachments replicate back and forth (38ms)
    ✓ Replicate same doc, same atts
    ✓ Replicate same doc, same atts 2
    ✓ Attachments replicate
    ✓ Attachment types replicate
    ✓ Many many attachments replicate
    ✓ Many many png attachments replicate
    ✓ Multiple attachments replicate
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698)
    ✓ Multiple attachments replicate, different docs png (#2698)
    ✓ #3932 attachments with tricky revpos
    ✓ replication with changing attachments
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication

  test.basics.js-http
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Testing issue #48 (53ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly (47ms)
    ✓ Fail to fetch a doc after db was deleted (60ms)
    ✓ Fail to fetch a doc after db was deleted (53ms)
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.basics.js-local
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Allows _access field in documents (#8171)
    ✓ Testing issue #48 (51ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted
    ✓ Fail to fetch a doc after db was deleted
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ should allow unicode doc ids
    ✓ should have same blob support for 2 dbs
    ✓ 6053, PouchDB.plugin() resets defaults
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.bulk_docs.js-local
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Deleting _local docs with bulkDocs, not found
    ✓ Deleting _local docs with bulkDocs, wrong rev
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (329ms)
    ✓ 2839 implement revs_limit (191ms)
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false

  test.bulk_docs.js-http
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs (41ms)
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (291ms)
    ✓ 2839 implement revs_limit
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false (44ms)

  test.bulk_get.js-http
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.bulk_get.js-local
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.changes.js-http
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit (38ms)
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs (88ms)
    ✓ Changes with style = all_docs and a callback for complete (79ms)
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (326ms)
    ✓ #3579 changes firing 1 too many times (78ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs (41ms)
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly (134ms)
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (101ms)
    ✓ changes are not duplicated (1025ms)
    ✓ supports return_docs=false
    ✓ should respects limit (73ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (199ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  test.changes.js-local
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs
    ✓ Changes with style = all_docs and a callback for complete
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (317ms)
    ✓ #3579 changes firing 1 too many times (68ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs (57ms)
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (102ms)
    ✓ changes are not duplicated (1017ms)
    ✓ supports return_docs=false
    ✓ should respects limit (66ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (67ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  changes-standalone
    - Changes reports errors

  test.close.js-local
    ✓ should emit destroyed even when closed (sync)
    ✓ should emit destroyed even when closed (async)
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ should emit closed even when destroyed (async #2)
    ✓ test unref for coverage
    ✓ test double unref for coverage
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test close-then-destroyed for coverage
************* run test done *************
pouchdb is testing ./Variants/levelup/variant15/levelup
/data/js-variants/multee
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink globally done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 400ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
Waiting for host to start .....
Host failed to start
************* run test done *************
pouchdb is testing ./Variants/levelup/variant14/levelup
/data/js-variants/multee
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 4s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink globally done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 391ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
Waiting for host to start .....
Host failed to start
************* run test done *************
pouchdb is testing ./Variants/levelup/variant13/levelup
/data/js-variants/multee
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink globally done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 510ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
Waiting for host to start ..
Host started :)
> pouchdb-monorepo@7.0.0-prerelease test-node
> bash bin/test-node.sh

Down server listening on port 3010
Seeded with: 1660147676722


  DB Setup
    ✓ PouchDB has a version
    ✓ PouchDB version matches package.json

  test.active_tasks.js
    ✓ Can add a task
    ✓ Can get tasks by id
    ✓ Can get all tasks
    ✓ Can update a task
    ✓ Can remove a task

  test.all_docs.js-http
    ✓ Testing all docs (172ms)
    ✓ Testing allDocs opts.keys (65ms)
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes (50ms)
    ✓ Testing updating in changes (49ms)
    ✓ Testing include docs
    ✓ Testing conflicts (53ms)
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria (152ms)
    ✓ test total_rows with both skip and limit (39ms)
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false (59ms)
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (259ms)
    ✓ test empty db
    ✓ test after db close
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  test.all_docs.js-local
    ✓ Testing all docs
    ✓ Testing allDocs opts.keys
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes
    ✓ Testing updating in changes
    ✓ Testing include docs
    ✓ Testing conflicts
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria
    ✓ test total_rows with both skip and limit
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (187ms)
    ✓ test empty db
    ✓ test after db close
    ✓ test unicode ids and revs
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  suite2 test.attachments.js-local
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes()
    ✓ #3074 live changes()
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (87ms)
    ✓ #2709 `revpos` with putAttachment
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js-http
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get() (47ms)
    ✓ #2858 {binary: true} in allDocs() 1 (41ms)
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes() (38ms)
    ✓ #3074 live changes() (38ms)
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments (44ms)
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs (39ms)
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs (46ms)
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc (43ms)
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false (41ms)
    ✓ Test getAttachment with specific rev (58ms)
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs (50ms)
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction) (38ms)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (138ms)
    ✓ #2709 `revpos` with putAttachment (39ms)
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js- local:http
    ✓ Attachments replicate back and forth (115ms)
    ✓ Replicate same doc, same atts (123ms)
    ✓ Replicate same doc, same atts 2 (147ms)
    ✓ Attachments replicate (69ms)
    ✓ Attachment types replicate (87ms)
    ✓ Many many attachments replicate (186ms)
    ✓ Many many png attachments replicate (209ms)
    ✓ Multiple attachments replicate (127ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (92ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (88ms)
    ✓ #3932 attachments with tricky revpos (131ms)
    ✓ replication with changing attachments (114ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (127ms)

  suite2 test.attachments.js- http:http
    ✓ Attachments replicate back and forth (164ms)
    ✓ Replicate same doc, same atts (178ms)
    ✓ Replicate same doc, same atts 2 (178ms)
    ✓ Attachments replicate (87ms)
    ✓ Attachment types replicate (102ms)
    ✓ Many many attachments replicate (379ms)
    ✓ Many many png attachments replicate (307ms)
    ✓ Multiple attachments replicate (127ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (129ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (125ms)
    ✓ #3932 attachments with tricky revpos (229ms)
    ✓ replication with changing attachments (168ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (173ms)

  suite2 test.attachments.js- http:local
    ✓ Attachments replicate back and forth (192ms)
    ✓ Replicate same doc, same atts (96ms)
    ✓ Replicate same doc, same atts 2 (95ms)
    ✓ Attachments replicate (105ms)
    ✓ Attachment types replicate (56ms)
    ✓ Many many attachments replicate (145ms)
    ✓ Many many png attachments replicate (157ms)
    ✓ Multiple attachments replicate (111ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (72ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (91ms)
    ✓ #3932 attachments with tricky revpos (151ms)
    ✓ replication with changing attachments (96ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (121ms)

  suite2 test.attachments.js- local:local
    ✓ Attachments replicate back and forth
    ✓ Replicate same doc, same atts
    ✓ Replicate same doc, same atts 2
    ✓ Attachments replicate
    ✓ Attachment types replicate
    ✓ Many many attachments replicate
    ✓ Many many png attachments replicate
    ✓ Multiple attachments replicate (38ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698)
    ✓ Multiple attachments replicate, different docs png (#2698)
    ✓ #3932 attachments with tricky revpos
    ✓ replication with changing attachments
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication

  test.basics.js-http
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Testing issue #48 (55ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted (54ms)
    ✓ Fail to fetch a doc after db was deleted (64ms)
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.basics.js-local
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Allows _access field in documents (#8171)
    ✓ Testing issue #48 (52ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted
    ✓ Fail to fetch a doc after db was deleted
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ should allow unicode doc ids
    ✓ should have same blob support for 2 dbs
    ✓ 6053, PouchDB.plugin() resets defaults
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.bulk_docs.js-local
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Deleting _local docs with bulkDocs, not found
    ✓ Deleting _local docs with bulkDocs, wrong rev
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (321ms)
    ✓ 2839 implement revs_limit (176ms)
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false

  test.bulk_docs.js-http
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (288ms)
    ✓ 2839 implement revs_limit
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false (44ms)

  test.bulk_get.js-http
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified (44ms)
    ✓ attachments are included when specified, using implicit rev

  test.bulk_get.js-local
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.changes.js-http
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs (64ms)
    ✓ Changes with style = all_docs and a callback for complete (59ms)
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (325ms)
    ✓ #3579 changes firing 1 too many times (82ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop (65ms)
    ✓ #3136 style=all_docs & include_docs (45ms)
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly (127ms)
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs (41ms)
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (102ms)
    ✓ changes are not duplicated (1024ms)
    ✓ supports return_docs=false
    ✓ should respects limit (81ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (202ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  test.changes.js-local
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs
    ✓ Changes with style = all_docs and a callback for complete
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (321ms)
    ✓ #3579 changes firing 1 too many times (70ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly (60ms)
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (100ms)
    ✓ changes are not duplicated (1020ms)
    ✓ supports return_docs=false
    ✓ should respects limit (66ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (145ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  changes-standalone
    - Changes reports errors

  test.close.js-local
    ✓ should emit destroyed even when closed (sync)
    ✓ should emit destroyed even when closed (async)
    ✓ should emit closed even when destroyed (async #2)
    ✓ test unref for coverage
    ✓ test double unref for coverage
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test close-then-destroyed for coverage
************* run test done *************
pouchdb is testing ./Variants/levelup/variant12/levelup
/data/js-variants/multee
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 4s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink globally done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 479ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
Waiting for host to start ..
Host started :)
> pouchdb-monorepo@7.0.0-prerelease test-node
> bash bin/test-node.sh

Down server listening on port 3010
Seeded with: 1660147730450


  DB Setup
    ✓ PouchDB has a version
    ✓ PouchDB version matches package.json

  test.active_tasks.js
    ✓ Can add a task
    ✓ Can get tasks by id
    ✓ Can get all tasks
    ✓ Can update a task
    ✓ Can remove a task

  test.all_docs.js-http
    ✓ Testing all docs (161ms)
    ✓ Testing allDocs opts.keys (60ms)
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes (70ms)
    ✓ Testing updating in changes (87ms)
    ✓ Testing include docs (40ms)
    ✓ Testing conflicts (51ms)
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria (142ms)
    ✓ test total_rows with both skip and limit
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false (60ms)
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (253ms)
    ✓ test empty db
    ✓ test after db close
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  test.all_docs.js-local
    ✓ Testing all docs
    ✓ Testing allDocs opts.keys
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes
    ✓ Testing updating in changes
    ✓ Testing include docs
    ✓ Testing conflicts
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria
    ✓ test total_rows with both skip and limit
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (195ms)
    ✓ test empty db
    ✓ test after db close
    ✓ test unicode ids and revs (43ms)
    ✓ 5793 _conflicts should not exist if no conflicts (45ms)
    ✓ #6230 Test allDocs opts update_seq: false (40ms)
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  suite2 test.attachments.js-local
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes()
    ✓ #3074 live changes()
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (94ms)
    ✓ #2709 `revpos` with putAttachment
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js-http
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts (38ms)
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes() (39ms)
    ✓ #3074 live changes()
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments (76ms)
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs (39ms)
    ✓ Test get() with binary:true and stubs (40ms)
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs (48ms)
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc (48ms)
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false (38ms)
    ✓ Test getAttachment with specific rev (41ms)
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs (110ms)
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction) (44ms)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (130ms)
    ✓ #2709 `revpos` with putAttachment (38ms)
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc (39ms)

  suite2 test.attachments.js- local:http
    ✓ Attachments replicate back and forth (131ms)
    ✓ Replicate same doc, same atts (110ms)
    ✓ Replicate same doc, same atts 2 (111ms)
    ✓ Attachments replicate (64ms)
    ✓ Attachment types replicate (55ms)
    ✓ Many many attachments replicate (193ms)
    ✓ Many many png attachments replicate (204ms)
    ✓ Multiple attachments replicate (88ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (82ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (70ms)
    ✓ #3932 attachments with tricky revpos (134ms)
    ✓ replication with changing attachments (107ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (127ms)

  suite2 test.attachments.js- http:http
    ✓ Attachments replicate back and forth (156ms)
    ✓ Replicate same doc, same atts (175ms)
    ✓ Replicate same doc, same atts 2 (177ms)
    ✓ Attachments replicate (82ms)
    ✓ Attachment types replicate (95ms)
    ✓ Many many attachments replicate (363ms)
    ✓ Many many png attachments replicate (284ms)
    ✓ Multiple attachments replicate (118ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (127ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (210ms)
    ✓ #3932 attachments with tricky revpos (240ms)
    ✓ replication with changing attachments (149ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (173ms)

  suite2 test.attachments.js- http:local
    ✓ Attachments replicate back and forth (102ms)
    ✓ Replicate same doc, same atts (99ms)
    ✓ Replicate same doc, same atts 2 (106ms)
    ✓ Attachments replicate (53ms)
    ✓ Attachment types replicate (58ms)
    ✓ Many many attachments replicate (142ms)
    ✓ Many many png attachments replicate (174ms)
    ✓ Multiple attachments replicate (82ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (72ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (85ms)
    ✓ #3932 attachments with tricky revpos (217ms)
    ✓ replication with changing attachments (93ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (118ms)

  suite2 test.attachments.js- local:local
    ✓ Attachments replicate back and forth
    ✓ Replicate same doc, same atts
    ✓ Replicate same doc, same atts 2
    ✓ Attachments replicate
    ✓ Attachment types replicate
    ✓ Many many attachments replicate
    ✓ Many many png attachments replicate
    ✓ Multiple attachments replicate
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698)
    ✓ Multiple attachments replicate, different docs png (#2698)
    ✓ #3932 attachments with tricky revpos
    ✓ replication with changing attachments
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication

  test.basics.js-http
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Testing issue #48 (54ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted (50ms)
    ✓ Fail to fetch a doc after db was deleted (57ms)
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.basics.js-local
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Allows _access field in documents (#8171)
    ✓ Testing issue #48 (53ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted
    ✓ Fail to fetch a doc after db was deleted
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ should allow unicode doc ids
    ✓ should have same blob support for 2 dbs
    ✓ 6053, PouchDB.plugin() resets defaults
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.bulk_docs.js-local
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Deleting _local docs with bulkDocs, not found
    ✓ Deleting _local docs with bulkDocs, wrong rev
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (270ms)
    ✓ 2839 implement revs_limit (183ms)
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false

  test.bulk_docs.js-http
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false (42ms)
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (287ms)
    ✓ 2839 implement revs_limit
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false (40ms)

  test.bulk_get.js-http
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.bulk_get.js-local
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.changes.js-http
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc (41ms)
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter (38ms)
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs (67ms)
    ✓ Changes with style = all_docs and a callback for complete (62ms)
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (324ms)
    ✓ #3579 changes firing 1 too many times (75ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop (39ms)
    ✓ #3136 style=all_docs & include_docs
    ✓ changes-filter with query params
    ✓ Non-live changes filter (51ms)
    ✓ Non-live changes filter, descending (38ms)
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids (45ms)
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly (174ms)
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs (60ms)
    ✓ Calling db.changes({since: 'now'}) (48ms)
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (101ms)
    ✓ changes are not duplicated (1025ms)
    ✓ supports return_docs=false
    ✓ should respects limit (71ms)
    ✓ doesn't throw if opts.complete is undefined (38ms)
    ✓ handle individual changes in live replication (284ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  test.changes.js-local
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc (43ms)
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs
    ✓ Changes with style = all_docs and a callback for complete
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (317ms)
    ✓ #3579 changes firing 1 too many times (65ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (101ms)
    ✓ changes are not duplicated (1020ms)
    ✓ supports return_docs=false
    ✓ should respects limit (73ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (75ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  changes-standalone
    - Changes reports errors

  test.close.js-local
    ✓ should emit destroyed even when closed (sync)
    ✓ should emit destroyed even when closed (async)
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ should emit closed even when destroyed (async #2)
    ✓ test unref for coverage
    ✓ test double unref for coverage
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test close-then-destroyed for coverage
************* run test done *************
pouchdb is testing ./Variants/levelup/variant11/levelup
/data/js-variants/multee
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink globally done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 412ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
Waiting for host to start ..
Host started :)
> pouchdb-monorepo@7.0.0-prerelease test-node
> bash bin/test-node.sh

Down server listening on port 3010
Seeded with: 1660147784918


  DB Setup
    ✓ PouchDB has a version
    ✓ PouchDB version matches package.json

  test.active_tasks.js
    ✓ Can add a task
    ✓ Can get tasks by id
    ✓ Can get all tasks
    ✓ Can update a task
    ✓ Can remove a task

  test.all_docs.js-http
    ✓ Testing all docs (160ms)
    ✓ Testing allDocs opts.keys (59ms)
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes (43ms)
    ✓ Testing updating in changes (96ms)
    ✓ Testing include docs (46ms)
    ✓ Testing conflicts (55ms)
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria (133ms)
    ✓ test total_rows with both skip and limit
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false (53ms)
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (254ms)
    ✓ test empty db
    ✓ test after db close
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  test.all_docs.js-local
    ✓ Testing all docs
    ✓ Testing allDocs opts.keys
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes
    ✓ Testing updating in changes
    ✓ Testing include docs
    ✓ Testing conflicts
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria
    ✓ test total_rows with both skip and limit
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (198ms)
    ✓ test empty db
    ✓ test after db close
    ✓ test unicode ids and revs
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  suite2 test.attachments.js-local
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes()
    ✓ #3074 live changes()
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (93ms)
    ✓ #2709 `revpos` with putAttachment
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js-http
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes() (53ms)
    ✓ #3074 live changes() (66ms)
    ✓ #3074 non-live changes(), no attachments (42ms)
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment (40ms)
    ✓ No length for non-stubs
    ✓ Test some attachments (45ms)
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback (38ms)
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs (44ms)
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc (42ms)
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev (40ms)
    ✓ Test getAttachment with diff revs and content (39ms)
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs (46ms)
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction) (45ms)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (128ms)
    ✓ #2709 `revpos` with putAttachment (56ms)
    ✓ #2709 `revpos` with inline attachment (65ms)
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js- local:http
    ✓ Attachments replicate back and forth (111ms)
    ✓ Replicate same doc, same atts (117ms)
    ✓ Replicate same doc, same atts 2 (122ms)
    ✓ Attachments replicate (74ms)
    ✓ Attachment types replicate (54ms)
    ✓ Many many attachments replicate (181ms)
    ✓ Many many png attachments replicate (235ms)
    ✓ Multiple attachments replicate (81ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (93ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (76ms)
    ✓ #3932 attachments with tricky revpos (147ms)
    ✓ replication with changing attachments (107ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (122ms)

  suite2 test.attachments.js- http:http
    ✓ Attachments replicate back and forth (265ms)
    ✓ Replicate same doc, same atts (174ms)
    ✓ Replicate same doc, same atts 2 (175ms)
    ✓ Attachments replicate (88ms)
    ✓ Attachment types replicate (102ms)
    ✓ Many many attachments replicate (383ms)
    ✓ Many many png attachments replicate (421ms)
    ✓ Multiple attachments replicate (126ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (128ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (160ms)
    ✓ #3932 attachments with tricky revpos (237ms)
    ✓ replication with changing attachments (152ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (170ms)

  suite2 test.attachments.js- http:local
    ✓ Attachments replicate back and forth (108ms)
    ✓ Replicate same doc, same atts (93ms)
    ✓ Replicate same doc, same atts 2 (100ms)
    ✓ Attachments replicate (56ms)
    ✓ Attachment types replicate (54ms)
    ✓ Many many attachments replicate (142ms)
    ✓ Many many png attachments replicate (185ms)
    ✓ Multiple attachments replicate (90ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (71ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (87ms)
    ✓ #3932 attachments with tricky revpos (247ms)
    ✓ replication with changing attachments (96ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (127ms)

  suite2 test.attachments.js- local:local
    ✓ Attachments replicate back and forth
    ✓ Replicate same doc, same atts
    ✓ Replicate same doc, same atts 2
    ✓ Attachments replicate
    ✓ Attachment types replicate
    ✓ Many many attachments replicate
    ✓ Many many png attachments replicate
    ✓ Multiple attachments replicate
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698)
    ✓ Multiple attachments replicate, different docs png (#2698)
    ✓ #3932 attachments with tricky revpos
    ✓ replication with changing attachments
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication

  test.basics.js-http
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style (38ms)
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Testing issue #48 (53ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted (55ms)
    ✓ Fail to fetch a doc after db was deleted (55ms)
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.basics.js-local
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Allows _access field in documents (#8171)
    ✓ Testing issue #48 (50ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists (69ms)
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted
    ✓ Fail to fetch a doc after db was deleted
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ should allow unicode doc ids
    ✓ should have same blob support for 2 dbs
    ✓ 6053, PouchDB.plugin() resets defaults
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.bulk_docs.js-local
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Deleting _local docs with bulkDocs, not found
    ✓ Deleting _local docs with bulkDocs, wrong rev
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (264ms)
    ✓ 2839 implement revs_limit (187ms)
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false

  test.bulk_docs.js-http
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2 (73ms)
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (291ms)
    ✓ 2839 implement revs_limit
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false (41ms)

  test.bulk_get.js-http
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.bulk_get.js-local
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.changes.js-http
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter (41ms)
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc (70ms)
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs (61ms)
    ✓ Changes with style = all_docs and a callback for complete (59ms)
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (323ms)
    ✓ #3579 changes firing 1 too many times (75ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs (40ms)
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs (40ms)
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter (40ms)
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly (141ms)
    ✓ Change entry for a deleted doc (38ms)
    ✓ changes large number of docs (51ms)
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (101ms)
    ✓ changes are not duplicated (1026ms)
    ✓ supports return_docs=false
    ✓ should respects limit (78ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (192ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine (49ms)
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  test.changes.js-local
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs
    ✓ Changes with style = all_docs and a callback for complete
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (317ms)
    ✓ #3579 changes firing 1 too many times (69ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (101ms)
    ✓ changes are not duplicated (1019ms)
    ✓ supports return_docs=false
    ✓ should respects limit (65ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (70ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  changes-standalone
    - Changes reports errors

  test.close.js-local
    ✓ should emit destroyed even when closed (sync)
    ✓ should emit destroyed even when closed (async)
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ should emit closed even when destroyed (async #2)
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test unref for coverage
    ✓ test double unref for coverage
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test close-then-destroyed for coverage
************* run test done *************
pouchdb is testing ./Variants/levelup/variant10/levelup
/data/js-variants/multee
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 4s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink globally done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 402ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
Waiting for host to start ..
Host started :)
> pouchdb-monorepo@7.0.0-prerelease test-node
> bash bin/test-node.sh

Down server listening on port 3010
Seeded with: 1660147838949


  DB Setup
    ✓ PouchDB has a version
    ✓ PouchDB version matches package.json

  test.active_tasks.js
    ✓ Can add a task
    ✓ Can get tasks by id
    ✓ Can get all tasks
    ✓ Can update a task
    ✓ Can remove a task

  test.all_docs.js-http
    ✓ Testing all docs (164ms)
    ✓ Testing allDocs opts.keys (61ms)
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes (44ms)
    ✓ Testing updating in changes (48ms)
    ✓ Testing include docs (39ms)
    ✓ Testing conflicts (55ms)
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria (136ms)
    ✓ test total_rows with both skip and limit (39ms)
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false (56ms)
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (347ms)
    ✓ test empty db
    ✓ test after db close
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  test.all_docs.js-local
    ✓ Testing all docs
    ✓ Testing allDocs opts.keys
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes
    ✓ Testing updating in changes
    ✓ Testing include docs
    ✓ Testing conflicts
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria
    ✓ test total_rows with both skip and limit
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (189ms)
    ✓ test empty db
    ✓ test after db close
    ✓ test unicode ids and revs
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  suite2 test.attachments.js-local
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes()
    ✓ #3074 live changes()
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (93ms)
    ✓ #2709 `revpos` with putAttachment
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js-http
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3 (38ms)
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet() (38ms)
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes() (42ms)
    ✓ #3074 live changes()
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions (48ms)
    ✓ #2771 allDocs() 8, empty attachment (46ms)
    ✓ No length for non-stubs (63ms)
    ✓ Test some attachments (53ms)
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback (39ms)
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs (49ms)
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc (42ms)
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data (38ms)
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs (40ms)
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev (38ms)
    ✓ Test getAttachment with diff revs and content (38ms)
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs (50ms)
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (126ms)
    ✓ #2709 `revpos` with putAttachment (46ms)
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js- local:http
    ✓ Attachments replicate back and forth (110ms)
    ✓ Replicate same doc, same atts (181ms)
    ✓ Replicate same doc, same atts 2 (120ms)
    ✓ Attachments replicate (65ms)
    ✓ Attachment types replicate (51ms)
    ✓ Many many attachments replicate (187ms)
    ✓ Many many png attachments replicate (214ms)
    ✓ Multiple attachments replicate (80ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (78ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (68ms)
    ✓ #3932 attachments with tricky revpos (136ms)
    ✓ replication with changing attachments (101ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (104ms)

  suite2 test.attachments.js- http:http
    ✓ Attachments replicate back and forth (166ms)
    ✓ Replicate same doc, same atts (177ms)
    ✓ Replicate same doc, same atts 2 (230ms)
    ✓ Attachments replicate (86ms)
    ✓ Attachment types replicate (89ms)
    ✓ Many many attachments replicate (338ms)
    ✓ Many many png attachments replicate (299ms)
    ✓ Multiple attachments replicate (122ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (120ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (121ms)
    ✓ #3932 attachments with tricky revpos (229ms)
    ✓ replication with changing attachments (147ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (278ms)

  suite2 test.attachments.js- http:local
    ✓ Attachments replicate back and forth (114ms)
    ✓ Replicate same doc, same atts (95ms)
    ✓ Replicate same doc, same atts 2 (102ms)
    ✓ Attachments replicate (56ms)
    ✓ Attachment types replicate (53ms)
    ✓ Many many attachments replicate (145ms)
    ✓ Many many png attachments replicate (154ms)
    ✓ Multiple attachments replicate (89ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (70ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (92ms)
    ✓ #3932 attachments with tricky revpos (162ms)
    ✓ replication with changing attachments (104ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (120ms)

  suite2 test.attachments.js- local:local
    ✓ Attachments replicate back and forth
    ✓ Replicate same doc, same atts
    ✓ Replicate same doc, same atts 2
    ✓ Attachments replicate
    ✓ Attachment types replicate
    ✓ Many many attachments replicate (48ms)
    ✓ Many many png attachments replicate (72ms)
    ✓ Multiple attachments replicate (47ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (45ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (43ms)
    ✓ #3932 attachments with tricky revpos (51ms)
    ✓ replication with changing attachments (48ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (42ms)

  test.basics.js-http
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object (44ms)
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id (38ms)
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs (55ms)
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Testing issue #48 (54ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted (67ms)
    ✓ Fail to fetch a doc after db was deleted (50ms)
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.basics.js-local
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Allows _access field in documents (#8171)
    ✓ Testing issue #48 (57ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted
    ✓ Fail to fetch a doc after db was deleted
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ should allow unicode doc ids
    ✓ should have same blob support for 2 dbs
    ✓ 6053, PouchDB.plugin() resets defaults
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.bulk_docs.js-local
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Deleting _local docs with bulkDocs, not found
    ✓ Deleting _local docs with bulkDocs, wrong rev
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (260ms)
    ✓ 2839 implement revs_limit (179ms)
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false

  test.bulk_docs.js-http
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false (70ms)
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs (39ms)
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (263ms)
    ✓ 2839 implement revs_limit
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false (43ms)

  test.bulk_get.js-http
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.bulk_get.js-local
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.changes.js-http
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc (62ms)
    ✓ Changes limit and filter (42ms)
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs (64ms)
    ✓ Changes with style = all_docs and a callback for complete (76ms)
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (323ms)
    ✓ #3579 changes firing 1 too many times (75ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs (55ms)
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter (43ms)
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly (206ms)
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (100ms)
    ✓ changes are not duplicated (1022ms)
    ✓ supports return_docs=false
    ✓ should respects limit (69ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (188ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  test.changes.js-local
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs
    ✓ Changes with style = all_docs and a callback for complete
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (315ms)
    ✓ #3579 changes firing 1 too many times (64ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (100ms)
    ✓ changes are not duplicated (1015ms)
    ✓ supports return_docs=false
    ✓ should respects limit (65ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (64ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  changes-standalone
    - Changes reports errors

  test.close.js-local
    ✓ should emit destroyed even when closed (sync)
    ✓ should emit destroyed even when closed (async)
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ should emit closed even when destroyed (async #2)
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test unref for coverage
    ✓ test double unref for coverage
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test close-then-destroyed for coverage
************* run test done *************
pouchdb is testing ./Variants/levelup/variant9/levelup
/data/js-variants/multee
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 7s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink globally done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 397ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 4s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
Waiting for host to start .....
Host failed to start
************* run test done *************
pouchdb is testing ./Variants/levelup/variant8/levelup
/data/js-variants/multee
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink globally done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 398ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
Waiting for host to start ..
Host started :)
> pouchdb-monorepo@7.0.0-prerelease test-node
> bash bin/test-node.sh

Down server listening on port 3010
Seeded with: 1660147934052


  DB Setup
    ✓ PouchDB has a version
    ✓ PouchDB version matches package.json

  test.active_tasks.js
    ✓ Can add a task
    ✓ Can get tasks by id
    ✓ Can get all tasks
    ✓ Can update a task
    ✓ Can remove a task

  test.all_docs.js-http
    ✓ Testing all docs (142ms)
    ✓ Testing allDocs opts.keys (63ms)
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes (44ms)
    ✓ Testing updating in changes (47ms)
    ✓ Testing include docs
    ✓ Testing conflicts (49ms)
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria (129ms)
    ✓ test total_rows with both skip and limit (57ms)
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false (56ms)
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (254ms)
    ✓ test empty db
    ✓ test after db close
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  test.all_docs.js-local
    ✓ Testing all docs
    ✓ Testing allDocs opts.keys
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes
    ✓ Testing updating in changes
    ✓ Testing include docs
    ✓ Testing conflicts
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria
    ✓ test total_rows with both skip and limit
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (189ms)
    ✓ test empty db
    ✓ test after db close
    ✓ test unicode ids and revs
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  suite2 test.attachments.js-local
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes()
    ✓ #3074 live changes()
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (89ms)
    ✓ #2709 `revpos` with putAttachment
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js-http
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1 (38ms)
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes() (40ms)
    ✓ #3074 live changes() (46ms)
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions (42ms)
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments (58ms)
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs (39ms)
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback (46ms)
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs (44ms)
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc (41ms)
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev (46ms)
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs (47ms)
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (132ms)
    ✓ #2709 `revpos` with putAttachment (45ms)
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js- local:http
    ✓ Attachments replicate back and forth (113ms)
    ✓ Replicate same doc, same atts (113ms)
    ✓ Replicate same doc, same atts 2 (182ms)
    ✓ Attachments replicate (64ms)
    ✓ Attachment types replicate (57ms)
    ✓ Many many attachments replicate (203ms)
    ✓ Many many png attachments replicate (192ms)
    ✓ Multiple attachments replicate (78ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (78ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (70ms)
    ✓ #3932 attachments with tricky revpos (134ms)
    ✓ replication with changing attachments (105ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (117ms)

  suite2 test.attachments.js- http:http
    ✓ Attachments replicate back and forth (166ms)
    ✓ Replicate same doc, same atts (172ms)
    ✓ Replicate same doc, same atts 2 (189ms)
    ✓ Attachments replicate (79ms)
    ✓ Attachment types replicate (91ms)
    ✓ Many many attachments replicate (369ms)
    ✓ Many many png attachments replicate (291ms)
    ✓ Multiple attachments replicate (125ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (117ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (118ms)
    ✓ #3932 attachments with tricky revpos (219ms)
    ✓ replication with changing attachments (150ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (183ms)

  suite2 test.attachments.js- http:local
    ✓ Attachments replicate back and forth (127ms)
    ✓ Replicate same doc, same atts (97ms)
    ✓ Replicate same doc, same atts 2 (101ms)
    ✓ Attachments replicate (52ms)
    ✓ Attachment types replicate (52ms)
    ✓ Many many attachments replicate (139ms)
    ✓ Many many png attachments replicate (161ms)
    ✓ Multiple attachments replicate (81ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (63ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (84ms)
    ✓ #3932 attachments with tricky revpos (141ms)
    ✓ replication with changing attachments (94ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (116ms)

  suite2 test.attachments.js- local:local
    ✓ Attachments replicate back and forth
    ✓ Replicate same doc, same atts
    ✓ Replicate same doc, same atts 2
    ✓ Attachments replicate
    ✓ Attachment types replicate
    ✓ Many many attachments replicate
    ✓ Many many png attachments replicate
    ✓ Multiple attachments replicate (64ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698)
    ✓ Multiple attachments replicate, different docs png (#2698)
    ✓ #3932 attachments with tricky revpos
    ✓ replication with changing attachments
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication

  test.basics.js-http
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub (59ms)
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Testing issue #48 (54ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted (46ms)
    ✓ Fail to fetch a doc after db was deleted (59ms)
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292 (70ms)
    ✓ issue 2888, successive deletes and writes (50ms)
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.basics.js-local
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Allows _access field in documents (#8171)
    ✓ Testing issue #48 (52ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted
    ✓ Fail to fetch a doc after db was deleted
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ should allow unicode doc ids
    ✓ should have same blob support for 2 dbs
    ✓ 6053, PouchDB.plugin() resets defaults
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.bulk_docs.js-local
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Deleting _local docs with bulkDocs, not found
    ✓ Deleting _local docs with bulkDocs, wrong rev
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (248ms)
    ✓ 2839 implement revs_limit (186ms)
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false

  test.bulk_docs.js-http
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (363ms)
    ✓ 2839 implement revs_limit
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false (44ms)

  test.bulk_get.js-http
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.bulk_get.js-local
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.changes.js-http
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs (66ms)
    ✓ Changes with style = all_docs and a callback for complete (57ms)
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (321ms)
    ✓ #3579 changes firing 1 too many times (72ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs (40ms)
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly (130ms)
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (101ms)
    ✓ changes are not duplicated (1023ms)
    ✓ supports return_docs=false
    ✓ should respects limit (74ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (199ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  test.changes.js-local
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs
    ✓ Changes with style = all_docs and a callback for complete
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (314ms)
    ✓ #3579 changes firing 1 too many times (73ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (101ms)
    ✓ changes are not duplicated (1016ms)
    ✓ supports return_docs=false
    ✓ should respects limit (81ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (69ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine (84ms)
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  changes-standalone
    - Changes reports errors

  test.close.js-local
    ✓ should emit destroyed even when closed (sync)
    ✓ should emit destroyed even when closed (async)
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ should emit closed even when destroyed (async #2)
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test unref for coverage
    ✓ test double unref for coverage
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test close-then-destroyed for coverage
************* run test done *************
pouchdb is testing ./Variants/levelup/variant7/levelup
/data/js-variants/multee
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink globally done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 403ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
Waiting for host to start .....
Host failed to start
************* run test done *************
pouchdb is testing ./Variants/levelup/variant6/levelup
/data/js-variants/multee
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink globally done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 407ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
Waiting for host to start .....
Host failed to start
************* run test done *************
pouchdb is testing ./Variants/levelup/variant5/levelup
/data/js-variants/multee
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink globally done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 426ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
Waiting for host to start .....
Host failed to start
************* run test done *************
pouchdb is testing ./Variants/levelup/variant4/levelup
/data/js-variants/multee
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 4s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink globally done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 395ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
Waiting for host to start .....
Host failed to start
************* run test done *************
pouchdb is testing ./Variants/levelup/variant3/levelup
/data/js-variants/multee
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink globally done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 399ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
Waiting for host to start ..
Host started :)
> pouchdb-monorepo@7.0.0-prerelease test-node
> bash bin/test-node.sh

Down server listening on port 3010
Seeded with: 1660148133550


  DB Setup
    ✓ PouchDB has a version
    ✓ PouchDB version matches package.json

  test.active_tasks.js
    ✓ Can add a task
    ✓ Can get tasks by id
    ✓ Can get all tasks
    ✓ Can update a task
    ✓ Can remove a task

  test.all_docs.js-http
    ✓ Testing all docs (143ms)
    ✓ Testing allDocs opts.keys (65ms)
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes (45ms)
    ✓ Testing updating in changes (46ms)
    ✓ Testing include docs
    ✓ Testing conflicts (47ms)
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria (140ms)
    ✓ test total_rows with both skip and limit (39ms)
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false (51ms)
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (266ms)
    ✓ test empty db
    ✓ test after db close
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  test.all_docs.js-local
    ✓ Testing all docs
    ✓ Testing allDocs opts.keys
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes
    ✓ Testing updating in changes
    ✓ Testing include docs
    ✓ Testing conflicts
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria
    ✓ test total_rows with both skip and limit
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (215ms)
    ✓ test empty db
    ✓ test after db close
    ✓ test unicode ids and revs
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  suite2 test.attachments.js-local
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes()
    ✓ #3074 live changes()
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (91ms)
    ✓ #2709 `revpos` with putAttachment
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js-http
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes()
    ✓ #3074 live changes() (44ms)
    ✓ #3074 non-live changes(), no attachments (38ms)
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments (73ms)
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback (38ms)
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs (49ms)
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc (43ms)
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev (39ms)
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs (52ms)
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (127ms)
    ✓ #2709 `revpos` with putAttachment (42ms)
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js- local:http
    ✓ Attachments replicate back and forth (108ms)
    ✓ Replicate same doc, same atts (110ms)
    ✓ Replicate same doc, same atts 2 (111ms)
    ✓ Attachments replicate (65ms)
    ✓ Attachment types replicate (53ms)
    ✓ Many many attachments replicate (209ms)
    ✓ Many many png attachments replicate (197ms)
    ✓ Multiple attachments replicate (83ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (113ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (83ms)
    ✓ #3932 attachments with tricky revpos (137ms)
    ✓ replication with changing attachments (98ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (123ms)

  suite2 test.attachments.js- http:http
    ✓ Attachments replicate back and forth (158ms)
    ✓ Replicate same doc, same atts (180ms)
    ✓ Replicate same doc, same atts 2 (172ms)
    ✓ Attachments replicate (80ms)
    ✓ Attachment types replicate (91ms)
    ✓ Many many attachments replicate (364ms)
    ✓ Many many png attachments replicate (341ms)
    ✓ Multiple attachments replicate (124ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (126ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (123ms)
    ✓ #3932 attachments with tricky revpos (236ms)
    ✓ replication with changing attachments (148ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (180ms)

  suite2 test.attachments.js- http:local
    ✓ Attachments replicate back and forth (101ms)
    ✓ Replicate same doc, same atts (93ms)
    ✓ Replicate same doc, same atts 2 (98ms)
    ✓ Attachments replicate (63ms)
    ✓ Attachment types replicate (50ms)
    ✓ Many many attachments replicate (140ms)
    ✓ Many many png attachments replicate (282ms)
    ✓ Multiple attachments replicate (86ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (77ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (86ms)
    ✓ #3932 attachments with tricky revpos (144ms)
    ✓ replication with changing attachments (95ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (118ms)

  suite2 test.attachments.js- local:local
    ✓ Attachments replicate back and forth
    ✓ Replicate same doc, same atts
    ✓ Replicate same doc, same atts 2
    ✓ Attachments replicate
    ✓ Attachment types replicate
    ✓ Many many attachments replicate
    ✓ Many many png attachments replicate
    ✓ Multiple attachments replicate (39ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698)
    ✓ Multiple attachments replicate, different docs png (#2698)
    ✓ #3932 attachments with tricky revpos
    ✓ replication with changing attachments
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication

  test.basics.js-http
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object (39ms)
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Testing issue #48 (53ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted (42ms)
    ✓ Fail to fetch a doc after db was deleted (47ms)
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.basics.js-local
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Allows _access field in documents (#8171)
    ✓ Testing issue #48 (53ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted
    ✓ Fail to fetch a doc after db was deleted
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ should allow unicode doc ids
    ✓ should have same blob support for 2 dbs
    ✓ 6053, PouchDB.plugin() resets defaults
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.bulk_docs.js-local
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Deleting _local docs with bulkDocs, not found
    ✓ Deleting _local docs with bulkDocs, wrong rev
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (274ms)
    ✓ 2839 implement revs_limit (289ms)
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false

  test.bulk_docs.js-http
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array (40ms)
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (291ms)
    ✓ 2839 implement revs_limit
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false (48ms)

  test.bulk_get.js-http
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.bulk_get.js-local
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.changes.js-http
    ✓ All changes
    ✓ Changes with complete callback as param (47ms)
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit (39ms)
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs (65ms)
    ✓ Changes with style = all_docs and a callback for complete (62ms)
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (322ms)
    ✓ #3579 changes firing 1 too many times (75ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter (38ms)
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly (129ms)
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs (43ms)
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (102ms)
    ✓ changes are not duplicated (1029ms)
    ✓ supports return_docs=false
    ✓ should respects limit (74ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (309ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  test.changes.js-local
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs
    ✓ Changes with style = all_docs and a callback for complete
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (317ms)
    ✓ #3579 changes firing 1 too many times (66ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly (38ms)
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (101ms)
    ✓ changes are not duplicated (1015ms)
    ✓ supports return_docs=false
    ✓ should respects limit (65ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (64ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine (69ms)
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  changes-standalone
    - Changes reports errors

  test.close.js-local
    ✓ should emit destroyed even when closed (sync)
    ✓ should emit destroyed even when closed (async)
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ should emit closed even when destroyed (async #2)
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test unref for coverage
    ✓ test double unref for coverage
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test close-then-destroyed for coverage
************* run test done *************
pouchdb is testing ./Variants/levelup/variant2/levelup
/data/js-variants/multee
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink globally done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 428ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
Waiting for host to start ..
Host started :)
> pouchdb-monorepo@7.0.0-prerelease test-node
> bash bin/test-node.sh

Down server listening on port 3010
Seeded with: 1660148186079


  DB Setup
    ✓ PouchDB has a version
    ✓ PouchDB version matches package.json

  test.active_tasks.js
    ✓ Can add a task
    ✓ Can get tasks by id
    ✓ Can get all tasks
    ✓ Can update a task
    ✓ Can remove a task

  test.all_docs.js-http
    ✓ Testing all docs (159ms)
    ✓ Testing allDocs opts.keys (60ms)
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes (44ms)
    ✓ Testing updating in changes (46ms)
    ✓ Testing include docs
    ✓ Testing conflicts (49ms)
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria (140ms)
    ✓ test total_rows with both skip and limit
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false (55ms)
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (346ms)
    ✓ test empty db
    ✓ test after db close
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  test.all_docs.js-local
    ✓ Testing all docs
    ✓ Testing allDocs opts.keys
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes
    ✓ Testing updating in changes
    ✓ Testing include docs
    ✓ Testing conflicts
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria
    ✓ test total_rows with both skip and limit
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (184ms)
    ✓ test empty db
    ✓ test after db close
    ✓ test unicode ids and revs
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  suite2 test.attachments.js-local
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes()
    ✓ #3074 live changes()
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (93ms)
    ✓ #2709 `revpos` with putAttachment
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js-http
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes() (43ms)
    ✓ #3074 live changes() (38ms)
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments (44ms)
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs (50ms)
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes (42ms)
    ✓ Test putAttachment with base64 plaintext (40ms)
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs (47ms)
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc (40ms)
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs (51ms)
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (124ms)
    ✓ #2709 `revpos` with putAttachment (42ms)
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js- local:http
    ✓ Attachments replicate back and forth (107ms)
    ✓ Replicate same doc, same atts (109ms)
    ✓ Replicate same doc, same atts 2 (109ms)
    ✓ Attachments replicate (60ms)
    ✓ Attachment types replicate (52ms)
    ✓ Many many attachments replicate (312ms)
    ✓ Many many png attachments replicate (199ms)
    ✓ Multiple attachments replicate (80ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (90ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (74ms)
    ✓ #3932 attachments with tricky revpos (141ms)
    ✓ replication with changing attachments (98ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (118ms)

  suite2 test.attachments.js- http:http
    ✓ Attachments replicate back and forth (158ms)
    ✓ Replicate same doc, same atts (173ms)
    ✓ Replicate same doc, same atts 2 (173ms)
    ✓ Attachments replicate (77ms)
    ✓ Attachment types replicate (92ms)
    ✓ Many many attachments replicate (520ms)
    ✓ Many many png attachments replicate (295ms)
    ✓ Multiple attachments replicate (126ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (120ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (123ms)
    ✓ #3932 attachments with tricky revpos (220ms)
    ✓ replication with changing attachments (157ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (164ms)

  suite2 test.attachments.js- http:local
    ✓ Attachments replicate back and forth (105ms)
    ✓ Replicate same doc, same atts (93ms)
    ✓ Replicate same doc, same atts 2 (173ms)
    ✓ Attachments replicate (69ms)
    ✓ Attachment types replicate (50ms)
    ✓ Many many attachments replicate (144ms)
    ✓ Many many png attachments replicate (157ms)
    ✓ Multiple attachments replicate (107ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (65ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (89ms)
    ✓ #3932 attachments with tricky revpos (141ms)
    ✓ replication with changing attachments (97ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (129ms)

  suite2 test.attachments.js- local:local
    ✓ Attachments replicate back and forth
    ✓ Replicate same doc, same atts
    ✓ Replicate same doc, same atts 2
    ✓ Attachments replicate
    ✓ Attachment types replicate
    ✓ Many many attachments replicate
    ✓ Many many png attachments replicate
    ✓ Multiple attachments replicate
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698)
    ✓ Multiple attachments replicate, different docs png (#2698)
    ✓ #3932 attachments with tricky revpos
    ✓ replication with changing attachments
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication

  test.basics.js-http
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Testing issue #48 (54ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted (51ms)
    ✓ Fail to fetch a doc after db was deleted (53ms)
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.basics.js-local
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Allows _access field in documents (#8171)
    ✓ Testing issue #48 (53ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted
    ✓ Fail to fetch a doc after db was deleted
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ should allow unicode doc ids
    ✓ should have same blob support for 2 dbs
    ✓ 6053, PouchDB.plugin() resets defaults
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.bulk_docs.js-local
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Deleting _local docs with bulkDocs, not found
    ✓ Deleting _local docs with bulkDocs, wrong rev
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (272ms)
    ✓ 2839 implement revs_limit (175ms)
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false

  test.bulk_docs.js-http
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs (41ms)
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (299ms)
    ✓ 2839 implement revs_limit
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false (41ms)

  test.bulk_get.js-http
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.bulk_get.js-local
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.changes.js-http
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs (60ms)
    ✓ Changes with style = all_docs and a callback for complete (55ms)
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (320ms)
    ✓ #3579 changes firing 1 too many times (69ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop (39ms)
    ✓ #3136 style=all_docs & include_docs (49ms)
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids (40ms)
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly (147ms)
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (101ms)
    ✓ changes are not duplicated (1024ms)
    ✓ supports return_docs=false
    ✓ should respects limit (72ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (212ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  test.changes.js-local
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs
    ✓ Changes with style = all_docs and a callback for complete
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (317ms)
    ✓ #3579 changes firing 1 too many times (65ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (101ms)
    ✓ changes are not duplicated (1017ms)
    ✓ supports return_docs=false
    ✓ should respects limit (66ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (65ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  changes-standalone
    - Changes reports errors

  test.close.js-local
    ✓ should emit destroyed even when closed (sync)
    ✓ should emit destroyed even when closed (async)
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ should emit closed even when destroyed (async #2)
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test unref for coverage
    ✓ test double unref for coverage
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test close-then-destroyed for coverage
************* run test done *************
pouchdb is testing ./Variants/levelup/variant1/levelup
/data/js-variants/multee
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 7s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink globally done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 403ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 4s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
Waiting for host to start .....
Host failed to start
************* run test done *************
variantsDepsNum: 6
/data/js-variants/multee
6
pouchdb is testing ./VariantsDeps/levelup/variant6/levelup
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink module done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 416ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
Waiting for host to start ..
Host started :)
> pouchdb-monorepo@7.0.0-prerelease test-node
> bash bin/test-node.sh

Down server listening on port 3010
Seeded with: 1660148280413


  DB Setup
    ✓ PouchDB has a version
    ✓ PouchDB version matches package.json

  test.active_tasks.js
    ✓ Can add a task
    ✓ Can get tasks by id
    ✓ Can get all tasks
    ✓ Can update a task
    ✓ Can remove a task

  test.all_docs.js-http
    ✓ Testing all docs (159ms)
    ✓ Testing allDocs opts.keys (61ms)
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes (41ms)
    ✓ Testing updating in changes (44ms)
    ✓ Testing include docs
    ✓ Testing conflicts (50ms)
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria (146ms)
    ✓ test total_rows with both skip and limit
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false (52ms)
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (249ms)
    ✓ test empty db
    ✓ test after db close
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  test.all_docs.js-local
    ✓ Testing all docs
    ✓ Testing allDocs opts.keys
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes
    ✓ Testing updating in changes
    ✓ Testing include docs
    ✓ Testing conflicts (59ms)
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria
    ✓ test total_rows with both skip and limit
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (183ms)
    ✓ test empty db
    ✓ test after db close
    ✓ test unicode ids and revs
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  suite2 test.attachments.js-local
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes()
    ✓ #3074 live changes()
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (91ms)
    ✓ #2709 `revpos` with putAttachment
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js-http
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet() (44ms)
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes() (39ms)
    ✓ #3074 live changes() (40ms)
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments (73ms)
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs (40ms)
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback (38ms)
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs (48ms)
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments (51ms)
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc (56ms)
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs (55ms)
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (132ms)
    ✓ #2709 `revpos` with putAttachment (40ms)
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js- local:http
    ✓ Attachments replicate back and forth (108ms)
    ✓ Replicate same doc, same atts (114ms)
    ✓ Replicate same doc, same atts 2 (107ms)
    ✓ Attachments replicate (67ms)
    ✓ Attachment types replicate (51ms)
    ✓ Many many attachments replicate (208ms)
    ✓ Many many png attachments replicate (204ms)
    ✓ Multiple attachments replicate (127ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (96ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (90ms)
    ✓ #3932 attachments with tricky revpos (135ms)
    ✓ replication with changing attachments (100ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (168ms)

  suite2 test.attachments.js- http:http
    ✓ Attachments replicate back and forth (160ms)
    ✓ Replicate same doc, same atts (179ms)
    ✓ Replicate same doc, same atts 2 (175ms)
    ✓ Attachments replicate (90ms)
    ✓ Attachment types replicate (91ms)
    ✓ Many many attachments replicate (363ms)
    ✓ Many many png attachments replicate (380ms)
    ✓ Multiple attachments replicate (121ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (121ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (121ms)
    ✓ #3932 attachments with tricky revpos (217ms)
    ✓ replication with changing attachments (176ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (166ms)

  suite2 test.attachments.js- http:local
    ✓ Attachments replicate back and forth (121ms)
    ✓ Replicate same doc, same atts (97ms)
    ✓ Replicate same doc, same atts 2 (95ms)
    ✓ Attachments replicate (66ms)
    ✓ Attachment types replicate (50ms)
    ✓ Many many attachments replicate (245ms)
    ✓ Many many png attachments replicate (147ms)
    ✓ Multiple attachments replicate (114ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (75ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (84ms)
    ✓ #3932 attachments with tricky revpos (135ms)
    ✓ replication with changing attachments (87ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (119ms)

  suite2 test.attachments.js- local:local
    ✓ Attachments replicate back and forth
    ✓ Replicate same doc, same atts
    ✓ Replicate same doc, same atts 2
    ✓ Attachments replicate
    ✓ Attachment types replicate
    ✓ Many many attachments replicate
    ✓ Many many png attachments replicate
    ✓ Multiple attachments replicate
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698)
    ✓ Multiple attachments replicate, different docs png (#2698)
    ✓ #3932 attachments with tricky revpos
    ✓ replication with changing attachments
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication

  test.basics.js-http
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object (44ms)
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Testing issue #48 (56ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted (50ms)
    ✓ Fail to fetch a doc after db was deleted (52ms)
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.basics.js-local
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Allows _access field in documents (#8171)
    ✓ Testing issue #48 (52ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted
    ✓ Fail to fetch a doc after db was deleted
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ should allow unicode doc ids
    ✓ should have same blob support for 2 dbs
    ✓ 6053, PouchDB.plugin() resets defaults
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.bulk_docs.js-local
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Deleting _local docs with bulkDocs, not found
    ✓ Deleting _local docs with bulkDocs, wrong rev
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (362ms)
    ✓ 2839 implement revs_limit (180ms)
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false

  test.bulk_docs.js-http
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (282ms)
    ✓ 2839 implement revs_limit
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false

  test.bulk_get.js-http
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.bulk_get.js-local
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.changes.js-http
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit (39ms)
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs (66ms)
    ✓ Changes with style = all_docs and a callback for complete (60ms)
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (323ms)
    ✓ #3579 changes firing 1 too many times (71ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly (130ms)
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs (39ms)
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (102ms)
    ✓ changes are not duplicated (1022ms)
    ✓ supports return_docs=false
    ✓ should respects limit (71ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (301ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  test.changes.js-local
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs
    ✓ Changes with style = all_docs and a callback for complete
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (316ms)
    ✓ #3579 changes firing 1 too many times (75ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (100ms)
    ✓ changes are not duplicated (1018ms)
    ✓ supports return_docs=false
    ✓ should respects limit (68ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (65ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  changes-standalone
    - Changes reports errors

  test.close.js-local
    ✓ should emit destroyed even when closed (sync)
    ✓ should emit destroyed even when closed (async)
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ should emit closed even when destroyed (async #2)
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test unref for coverage
    ✓ test double unref for coverage
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test close-then-destroyed for coverage
************* run test done *************
pouchdb is testing ./VariantsDeps/levelup/variant5/levelup
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink module done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 403ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
Waiting for host to start ..
Host started :)
> pouchdb-monorepo@7.0.0-prerelease test-node
> bash bin/test-node.sh

Down server listening on port 3010
Seeded with: 1660148332864


  DB Setup
    ✓ PouchDB has a version
    ✓ PouchDB version matches package.json

  test.active_tasks.js
    ✓ Can add a task
    ✓ Can get tasks by id
    ✓ Can get all tasks
    ✓ Can update a task
    ✓ Can remove a task

  test.all_docs.js-http
    ✓ Testing all docs (161ms)
    ✓ Testing allDocs opts.keys (62ms)
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes (42ms)
    ✓ Testing updating in changes (47ms)
    ✓ Testing include docs
    ✓ Testing conflicts (50ms)
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria (140ms)
    ✓ test total_rows with both skip and limit
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false (53ms)
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (252ms)
    ✓ test empty db
    ✓ test after db close
    ✓ 5793 _conflicts should not exist if no conflicts (39ms)
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  test.all_docs.js-local
    ✓ Testing all docs
    ✓ Testing allDocs opts.keys
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes
    ✓ Testing updating in changes
    ✓ Testing include docs
    ✓ Testing conflicts
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria
    ✓ test total_rows with both skip and limit
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (189ms)
    ✓ test empty db
    ✓ test after db close
    ✓ test unicode ids and revs
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  suite2 test.attachments.js-local
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes()
    ✓ #3074 live changes()
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false (39ms)
    ✓ Test getAttachment with specific rev
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (91ms)
    ✓ #2709 `revpos` with putAttachment
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js-http
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes() (40ms)
    ✓ #3074 live changes() (41ms)
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments (74ms)
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs (45ms)
    ✓ proper stub behavior (47ms)
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs (47ms)
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc (44ms)
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs (54ms)
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction) (38ms)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (128ms)
    ✓ #2709 `revpos` with putAttachment (42ms)
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js- local:http
    ✓ Attachments replicate back and forth (117ms)
    ✓ Replicate same doc, same atts (111ms)
    ✓ Replicate same doc, same atts 2 (117ms)
    ✓ Attachments replicate (63ms)
    ✓ Attachment types replicate (55ms)
    ✓ Many many attachments replicate (282ms)
    ✓ Many many png attachments replicate (195ms)
    ✓ Multiple attachments replicate (76ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (88ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (68ms)
    ✓ #3932 attachments with tricky revpos (137ms)
    ✓ replication with changing attachments (91ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (113ms)

  suite2 test.attachments.js- http:http
    ✓ Attachments replicate back and forth (162ms)
    ✓ Replicate same doc, same atts (175ms)
    ✓ Replicate same doc, same atts 2 (177ms)
    ✓ Attachments replicate (81ms)
    ✓ Attachment types replicate (95ms)
    ✓ Many many attachments replicate (472ms)
    ✓ Many many png attachments replicate (302ms)
    ✓ Multiple attachments replicate (126ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (127ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (125ms)
    ✓ #3932 attachments with tricky revpos (230ms)
    ✓ replication with changing attachments (150ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (175ms)

  suite2 test.attachments.js- http:local
    ✓ Attachments replicate back and forth (102ms)
    ✓ Replicate same doc, same atts (94ms)
    ✓ Replicate same doc, same atts 2 (139ms)
    ✓ Attachments replicate (63ms)
    ✓ Attachment types replicate (52ms)
    ✓ Many many attachments replicate (139ms)
    ✓ Many many png attachments replicate (170ms)
    ✓ Multiple attachments replicate (82ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (74ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (95ms)
    ✓ #3932 attachments with tricky revpos (145ms)
    ✓ replication with changing attachments (94ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (138ms)

  suite2 test.attachments.js- local:local
    ✓ Attachments replicate back and forth
    ✓ Replicate same doc, same atts
    ✓ Replicate same doc, same atts 2
    ✓ Attachments replicate
    ✓ Attachment types replicate
    ✓ Many many attachments replicate
    ✓ Many many png attachments replicate
    ✓ Multiple attachments replicate
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698)
    ✓ Multiple attachments replicate, different docs png (#2698)
    ✓ #3932 attachments with tricky revpos
    ✓ replication with changing attachments
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication

  test.basics.js-http
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Testing issue #48 (57ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted (50ms)
    ✓ Fail to fetch a doc after db was deleted (60ms)
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.basics.js-local
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Allows _access field in documents (#8171)
    ✓ Testing issue #48 (51ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted
    ✓ Fail to fetch a doc after db was deleted
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ should allow unicode doc ids
    ✓ should have same blob support for 2 dbs
    ✓ 6053, PouchDB.plugin() resets defaults
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.bulk_docs.js-local
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Deleting _local docs with bulkDocs, not found
    ✓ Deleting _local docs with bulkDocs, wrong rev
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (264ms)
    ✓ 2839 implement revs_limit (183ms)
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false

  test.bulk_docs.js-http
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (294ms)
    ✓ 2839 implement revs_limit
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false (44ms)

  test.bulk_get.js-http
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default (51ms)
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.bulk_get.js-local
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.changes.js-http
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit (41ms)
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs (63ms)
    ✓ Changes with style = all_docs and a callback for complete (66ms)
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (325ms)
    ✓ #3579 changes firing 1 too many times (81ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs (39ms)
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly (122ms)
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs (44ms)
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (100ms)
    ✓ changes are not duplicated (1021ms)
    ✓ supports return_docs=false
    ✓ should respects limit (74ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (194ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  test.changes.js-local
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs
    ✓ Changes with style = all_docs and a callback for complete
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (316ms)
    ✓ #3579 changes firing 1 too many times (65ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (100ms)
    ✓ changes are not duplicated (1016ms)
    ✓ supports return_docs=false
    ✓ should respects limit (67ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (76ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  changes-standalone
    - Changes reports errors

  test.close.js-local
    ✓ should emit destroyed even when closed (sync)
    ✓ should emit destroyed even when closed (async)
    ✓ should emit closed even when destroyed (async #2)
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test unref for coverage
    ✓ test double unref for coverage
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test close-then-destroyed for coverage
************* run test done *************
pouchdb is testing ./VariantsDeps/levelup/variant4/levelup
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink module done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 402ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
Waiting for host to start .....
Host failed to start
************* run test done *************
pouchdb is testing ./VariantsDeps/levelup/variant3/levelup
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 4s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink module done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 398ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
Waiting for host to start .....
Host failed to start
************* run test done *************
pouchdb is testing ./VariantsDeps/levelup/variant2/levelup
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 4s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink module done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 400ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
Waiting for host to start ..
Host started :)
> pouchdb-monorepo@7.0.0-prerelease test-node
> bash bin/test-node.sh

Down server listening on port 3010
Seeded with: 1660148459872


  DB Setup
    ✓ PouchDB has a version
    ✓ PouchDB version matches package.json

  test.active_tasks.js
    ✓ Can add a task
    ✓ Can get tasks by id
    ✓ Can get all tasks
    ✓ Can update a task
    ✓ Can remove a task

  test.all_docs.js-http
    ✓ Testing all docs (151ms)
    ✓ Testing allDocs opts.keys (69ms)
    ✓ Testing allDocs opts.keys with skip (42ms)
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes (44ms)
    ✓ Testing updating in changes (46ms)
    ✓ Testing include docs
    ✓ Testing conflicts (53ms)
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria (149ms)
    ✓ test total_rows with both skip and limit (39ms)
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false (51ms)
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (247ms)
    ✓ test empty db
    ✓ test after db close
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  test.all_docs.js-local
    ✓ Testing all docs
    ✓ Testing allDocs opts.keys
    ✓ Testing allDocs opts.keys with skip
    ✓ Testing allDocs opts.keys with limit
    ✓ Testing allDocs invalid opts.keys
    ✓ Testing deleting in changes
    ✓ Testing updating in changes
    ✓ Testing include docs
    ✓ Testing conflicts
    ✓ test basic collation
    ✓ 3883 start_key end_key aliases
    ✓ test total_rows with a variety of criteria
    ✓ test total_rows with both skip and limit
    ✓ test limit option and total_rows
    ✓ test escaped startkey/endkey
    ✓ test "key" option
    ✓ test inclusive_end=false
    ✓ test descending with startkey/endkey
    ✓ #3082 test wrong num results returned (198ms)
    ✓ test empty db
    ✓ test after db close
    ✓ test unicode ids and revs
    ✓ 5793 _conflicts should not exist if no conflicts
    ✓ #6230 Test allDocs opts update_seq: false
    ✓ #6230 Test allDocs opts update_seq: true
    ✓ #6230 Test allDocs opts with update_seq missing

  suite2 test.attachments.js-local
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes()
    ✓ #3074 live changes()
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev
    ✓ Test getAttachment with diff revs and content
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext
    ✓ putAttachment and getAttachment with png data
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (98ms)
    ✓ #2709 `revpos` with putAttachment
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js-http
    ✓ 3357 Attachment names cant start with _
    ✓ 5736 warning for putAttachment without content_type
    ✓ 5736 warning for bulkDocs attachments without content_type
    ✓ fetch atts with open_revs and missing
    ✓ issue 2803 should throw 412
    ✓ issue 2803 should throw 412 part 2
    ✓ issue 2803 should throw 412 part 3
    ✓ issue 2803 should throw 412 part 4
    ✓ #2858 {binary: true} in get()
    ✓ #2858 {binary: true} in allDocs() 1
    ✓ #2858 {binary: true} in allDocs() 2
    ✓ #2858 {binary: true} in allDocs() 3
    ✓ #2858 {binary: true} in allDocs() 4
    ✓ #2858 {binary: true} in allDocs() 5
    ✓ #2858 {binary: true} in allDocs(), many atts
    ✓ #2858 {binary: true} in allDocs(), mixed atts
    ✓ #2858 {binary: true} in changes() non-live
    ✓ #2858 {binary: true} in changes() non-live, many atts
    ✓ #2858 {binary: true} in changes() non-live, mixed atts
    ✓ #2858 {binary: true} non-live changes, complete event
    ✓ #2858 {binary: true} in live changes
    ✓ #2858 {binary: true} in live changes, mixed atts
    ✓ #2858 {binary: true} in live+retry changes
    ✓ #2858 {binary: true} in live changes, attachments:false
    ✓ #2858 {binary: true} in live changes, include_docs:false (38ms)
    ✓ #6736 {binary: true} in bulkGet()
    ✓ Measures length correctly after put()
    ✓ #3074 non-live changes() (41ms)
    ✓ #3074 live changes() (43ms)
    ✓ #3074 non-live changes(), no attachments
    ✓ #3074 live changes(), no attachments
    ✓ #3881 filter extraneous keys from _attachments
    ✓ #2771 allDocs() 1, single attachment (40ms)
    ✓ #2771 allDocs() 2, many docs same att
    ✓ #2771 allDocs() 3, many docs diff atts
    ✓ #2771 allDocs() 4, mix of atts and no atts
    ✓ #2771 allDocs() 5, no atts
    ✓ #2771 allDocs() 6, no docs
    ✓ #2771 allDocs() 7, revisions and deletions
    ✓ #2771 allDocs() 8, empty attachment
    ✓ No length for non-stubs
    ✓ Test some attachments (75ms)
    ✓ Test getAttachment
    ✓ Test getAttachment with stubs
    ✓ Test get() with binary:true and stubs
    ✓ Test attachments in allDocs/changes
    ✓ Test putAttachment with base64 plaintext
    ✓ Test putAttachment with invalid base64
    ✓ Test getAttachment with empty text
    ✓ Test getAttachment with normal text
    ✓ Test getAttachment with PNG
    ✓ Test getAttachment with PNG using bulkDocs
    ✓ Test getAttachment with PNG using post
    ✓ Test postAttachment with PNG then bulkDocs
    ✓ proper stub behavior
    ✓ Testing with invalid docs
    ✓ Test create attachment and doc in one go
    ✓ Test create attachment and doc in one go without callback
    ✓ Test create attachment without callback (38ms)
    ✓ Test put attachment on a doc without attachments
    ✓ Test put attachment with unencoded name
    ✓ 3963 length property on stubs (47ms)
    ✓ Testing with invalid rev
    ✓ Test put another attachment on a doc with attachments
    ✓ Test get with attachments: true if empty attachments
    ✓ Test delete attachment from a doc (48ms)
    ✓ Test a document with a json string attachment
    ✓ Test remove doc with attachment
    ✓ Try to insert a doc with unencoded attachment
    ✓ Try to get attachment of unexistent doc
    ✓ Test synchronous putAttachment with text data
    ✓ Test synchronous putAttachment with no text data
    ✓ Test put with partial stubs
    ✓ Test put with attachments and new_edits=false
    ✓ Test getAttachment with specific rev (40ms)
    ✓ Test getAttachment with diff revs and content (40ms)
    ✓ Test stubs
    ✓ Try to get unexistent attachment of some doc
    ✓ putAttachment and getAttachment with plaintext (41ms)
    ✓ putAttachment and getAttachment with png data (39ms)
    ✓ putAttachment in new doc with base64
    ✓ #2818 - save same attachment in different revs (59ms)
    ✓ #2818 - save same attachment many times in parallel
    ✓ #2818 - revisions keep attachments (no compaction) (40ms)
    ✓ #2818 - doesn't throw 409 if same filename
    ✓ #3008 test correct encoding/decoding of \u0000 etc.
    ✓ putAttachment and getAttachment with big png data (132ms)
    ✓ #2709 `revpos` with putAttachment (49ms)
    ✓ #2709 `revpos` with inline attachment
    ✓ #2709 `revpos` with allDocs
    ✓ #7403 {attachments: true, binary: true, include_docs: true} in allDocs with one missing doc

  suite2 test.attachments.js- local:http
    ✓ Attachments replicate back and forth (113ms)
    ✓ Replicate same doc, same atts (113ms)
    ✓ Replicate same doc, same atts 2 (130ms)
    ✓ Attachments replicate (63ms)
    ✓ Attachment types replicate (50ms)
    ✓ Many many attachments replicate (187ms)
    ✓ Many many png attachments replicate (213ms)
    ✓ Multiple attachments replicate (81ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (80ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (77ms)
    ✓ #3932 attachments with tricky revpos (146ms)
    ✓ replication with changing attachments (145ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (118ms)

  suite2 test.attachments.js- http:http
    ✓ Attachments replicate back and forth (227ms)
    ✓ Replicate same doc, same atts (171ms)
    ✓ Replicate same doc, same atts 2 (168ms)
    ✓ Attachments replicate (78ms)
    ✓ Attachment types replicate (118ms)
    ✓ Many many attachments replicate (345ms)
    ✓ Many many png attachments replicate (301ms)
    ✓ Multiple attachments replicate (137ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (135ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (138ms)
    ✓ #3932 attachments with tricky revpos (222ms)
    ✓ replication with changing attachments (153ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (181ms)

  suite2 test.attachments.js- http:local
    ✓ Attachments replicate back and forth (110ms)
    ✓ Replicate same doc, same atts (111ms)
    ✓ Replicate same doc, same atts 2 (108ms)
    ✓ Attachments replicate (88ms)
    ✓ Attachment types replicate (57ms)
    ✓ Many many attachments replicate (148ms)
    ✓ Many many png attachments replicate (174ms)
    ✓ Multiple attachments replicate (134ms)
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698) (74ms)
    ✓ Multiple attachments replicate, different docs png (#2698) (88ms)
    ✓ #3932 attachments with tricky revpos (143ms)
    ✓ replication with changing attachments (92ms)
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication (123ms)

  suite2 test.attachments.js- local:local
    ✓ Attachments replicate back and forth
    ✓ Replicate same doc, same atts
    ✓ Replicate same doc, same atts 2
    ✓ Attachments replicate
    ✓ Attachment types replicate
    ✓ Many many attachments replicate
    ✓ Many many png attachments replicate
    ✓ Multiple attachments replicate
    - #3961 Many attachments on same doc
    ✓ Multiple attachments replicate, different docs (#2698)
    ✓ Multiple attachments replicate, different docs png (#2698)
    ✓ #3932 attachments with tricky revpos
    ✓ replication with changing attachments
    ✓ 3955 race condition in put
    ✓ #8456 bad attachment rev after replication

  test.basics.js-http
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Testing issue #48 (54ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted (46ms)
    ✓ Fail to fetch a doc after db was deleted (50ms)
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.basics.js-local
    ✓ Create a pouch without new keyword
    ✓ Name is accessible via instance
    ✓ 4314 Create a pouch with + in name
    ✓ Creating Pouch without name will throw
    ✓ 4314 Create a pouch with urlencoded name
    ✓ 4219 destroy a pouch
    ✓ 4339 throw useful error if method called on stale instance
    ✓ [4595] should reject xhr errors
    ✓ [4595] should emit error event on xhr error
    ✓ Add a doc
    ✓ Get invalid id
    ✓ Missing doc should contain ID in error object
    ✓ PUTed Conflicted doc should contain ID in error object
    ✓ POSTed Conflicted doc should contain ID in error object
    ✓ Add a doc with a promise
    ✓ Add a doc with opts object
    ✓ Modify a doc
    ✓ Modifying a doc that has rewritten content
    ✓ Modify a doc with a promise
    ✓ Read db id
    ✓ Read db id with promise
    ✓ Close db
    ✓ Close db with a promise
    ✓ Read db id after closing Close
    ✓ Modify a doc with incorrect rev
    ✓ Remove doc
    ✓ Remove doc with a promise
    ✓ Remove doc with new syntax
    ✓ Remove doc with new syntax and a promise
    ✓ Doc removal leaves only stub
    ✓ Remove doc twice with specified id
    ✓ Remove doc, no callback
    ✓ Delete document without id
    ✓ Delete document with many args
    ✓ Delete document with many args, callback style
    ✓ Delete doc with id + rev + no opts
    ✓ Delete doc with id + rev + no opts, callback style
    ✓ Delete doc with doc + opts
    ✓ Delete doc with doc + opts, callback style
    ✓ Delete doc with rev in opts
    ✓ Bulk docs
    ✓ Bulk docs with a promise
    ✓ Basic checks
    ✓ update with invalid rev
    ✓ Doc validation
    ✓ Replication fields (#2442)
    ✓ Allows _access field in documents (#8171)
    ✓ Testing issue #48 (54ms)
    ✓ Testing valid id
    ✓ Put doc without _id should fail
    ✓ Put doc with bad reserved id should fail
    ✓ update_seq persists
    ✓ deletions persists
    ✓ #4126 should not store raw Dates
    ✓ Create a db with a reserved name
    ✓ Error when document is not an object
    ✓ Test instance update_seq updates correctly
    ✓ Fail to fetch a doc after db was deleted
    ✓ Fail to fetch a doc after db was deleted
    ✓ Cant add docs with empty ids
    ✓ Test doc with percent in ID
    ✓ db.info should give auto_compaction = false (#2744)
    ✓ db.info should give auto_compaction = true (#2744)
    ✓ db.info should give adapter name (#3567)
    ✓ db.info should give correct doc_count
    ✓ putting returns {ok: true}
    ✓ putting is override-able
    ✓ issue 2779, deleted docs, old revs COUCHDB-292
    ✓ issue 2888, successive deletes and writes
    ✓ 2 invalid puts
    ✓ Docs save "null" value
    ✓ replace PouchDB.destroy() (express-pouchdb#203)
    ✓ 3968, keeps all object fields
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ test info() after db close
    ✓ test get() after db close
    ✓ test close() after db close
    ✓ 7259 should have "this" keyword properly scoped
    ✓ should allow unicode doc ids
    ✓ should have same blob support for 2 dbs
    ✓ 6053, PouchDB.plugin() resets defaults
    ✓ #5471 PouchDB.plugin() should throw error if passed wrong type or empty object

  test.bulk_docs.js-local
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs
    ✓ Deleting _local docs with bulkDocs, not found
    ✓ Deleting _local docs with bulkDocs, wrong rev
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (266ms)
    ✓ 2839 implement revs_limit (188ms)
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false

  test.bulk_docs.js-http
    ✓ Testing bulk docs
    ✓ #6039 test id in bulk docs for conflict
    ✓ No id in bulk docs
    ✓ No _rev and new_edits=false
    ✓ 7829 bare rev 1- with new_edits=false
    ✓ Test empty bulkDocs
    ✓ Test many bulkDocs
    ✓ Test errors on invalid doc id
    ✓ Test two errors on invalid doc id
    ✓ No docs
    ✓ Jira 911
    ✓ Test multiple bulkdocs
    ✓ #2935 new_edits=false correct number
    ✓ #2935 new_edits=false correct number 2
    ✓ bulk docs update then delete then conflict
    ✓ bulk_docs delete then undelete
    ✓ #2935 new_edits=false with single unauthorized
    ✓ Deleting _local docs with bulkDocs (39ms)
    ✓ Bulk with new_edits=false
    ✓ Testing successive new_edits to the same doc
    ✓ #3062 bulkDocs with staggered seqs
    ✓ Testing successive new_edits to the same doc, different content
    ✓ Testing successive new_edits to two doc
    ✓ Deletion with new_edits=false
    ✓ Deletion with new_edits=false, no history
    ✓ Modification with new_edits=false, no history
    ✓ Deletion with new_edits=false, no history, no revisions
    ✓ Testing new_edits=false in req body
    ✓ 656 regression in handling deleted docs
    ✓ Test quotes in doc ids
    ✓ Bulk docs empty list
    ✓ handles simultaneous writes
    ✓ bulk docs input by array
    ✓ Bulk empty list
    ✓ Bulk docs not an array
    ✓ Bulk docs not an object
    ✓ Bulk docs two different revisions to same document id
    ✓ 4204 respect revs_limit (293ms)
    ✓ 2839 implement revs_limit
    ✓ 4372 revs_limit deletes old revisions of the doc
    ✓ 4372 revs_limit with auto_compaction deletes old revisions of the doc
    ✓ 4712 invalid rev for new doc generates conflict
    ✓ 5793 bulk docs accepts _conflicts when new_edits=false (39ms)

  test.bulk_get.js-http
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.bulk_get.js-local
    ✓ test bulk get with rev specified
    ✓ test bulk get with latest=true
    ✓ test bulk get with no rev specified
    ✓ _revisions is not returned by default
    ✓ #5886 bulkGet with reserved id
    ✓ _revisions is returned when specified
    ✓ _revisions is returned when specified, using implicit rev
    ✓ attachments are not included by default
    ✓ attachments are included when specified
    ✓ attachments are included when specified, using implicit rev

  test.changes.js-http
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit (51ms)
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs (61ms)
    ✓ Changes with style = all_docs and a callback for complete (60ms)
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (321ms)
    ✓ #3579 changes firing 1 too many times (73ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly (182ms)
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs (41ms)
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (101ms)
    ✓ changes are not duplicated (1024ms)
    ✓ supports return_docs=false
    ✓ should respects limit (73ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (193ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  test.changes.js-local
    ✓ All changes
    ✓ Changes with complete callback as param
    ✓ Promise resolved when changes cancelled
    - Live changes should clean listener when cancelled
    ✓ Changes Since
    ✓ Changes Since and limit limit 1
    ✓ Changes Since and limit limit 0
    ✓ Changes limit
    ✓ Changes with filter not present in ddoc
    ✓ Changes with `filters` key not present in ddoc
    ✓ Changes limit and filter
    ✓ Changes with shorthand function name
    ✓ Changes with filter from nonexistent ddoc
    ✓ Changes with view not present in ddoc
    ✓ Changes with `views` key not present in ddoc
    ✓ #4451 Changes with invalid view filter
    ✓ 3356 throw inside a filter
    ✓ Changes with missing param `view` in request
    ✓ Changes limit and view instead of filter
    ✓ #3609 view option implies filter: _view
    ✓ Immediately cancel changes
    ✓ Changes with invalid ddoc view name
    ✓ Changes with invalid ddoc view name 2
    ✓ Changes with style = all_docs
    ✓ Changes with style = all_docs and a callback for complete
    ✓ Changes limit = 0
    ✓ Changes doc
    - Descending many changes
    ✓ live-changes
    ✓ Multiple watchers
    ✓ Continuous changes doc
    ✓ Cancel changes (316ms)
    ✓ #3579 changes firing 1 too many times (72ms)
    ✓ Kill database while listening to live changes
    ✓ #3136 style=all_docs
    ✓ #4191 revs_diff causes endless loop
    ✓ #3136 style=all_docs & include_docs
    ✓ changes-filter with query params
    ✓ Non-live changes filter
    ✓ Non-live changes filter, descending
    ✓ #2569 Non-live doc_ids filter
    ✓ #2569 Big non-live doc_ids filter
    ✓ #2569 Live doc_ids filter
    ✓ #2569 Big live doc_ids filter
    ✓ #2569 Non-live doc_ids filter with filter=_doc_ids
    ✓ #2569 Live doc_ids filter with filter=_doc_ids
    ✓ Changes to same doc are grouped
    ✓ Changes with conflicts are handled correctly (41ms)
    ✓ Change entry for a deleted doc
    ✓ changes large number of docs
    ✓ Calling db.changes({since: 'now'})
    ✓ Calling db.changes({since: 'latest'})
    ✓ Closing db does not cause a crash if changes cancelled
    ✓ fire-complete-on-cancel (100ms)
    ✓ changes are not duplicated (1019ms)
    ✓ supports return_docs=false
    ✓ should respects limit (75ms)
    ✓ doesn't throw if opts.complete is undefined
    ✓ handle individual changes in live replication (65ms)
    ✓ changes-filter without filter
    ✓ #3539 - Exception in changes is fine
    ✓ Changes with selector
    ✓ Changes with selector, explicit filter
    ✓ Changes with selector and mismatched filter
    ✓ Changes with limit and selector

  changes-standalone
    - Changes reports errors

  test.close.js-local
    ✓ should emit destroyed even when closed (sync)
    ✓ should emit destroyed even when closed (async)
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ should emit closed even when destroyed (async #2)
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test unref for coverage
    ✓ test double unref for coverage
precondition_failed: Database not open
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/packages/node_modules/pouchdb/lib/index.js:614:16)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at commonUtils.loadPouchDBForNode (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:92:17)
    at commonUtils.loadPouchDB (/data/js-variants/multee/Clients/levelup/pouchdb/tests/common-utils.js:78:39)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/tests/integration/node.setup.js:21:28)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Module.require (node:internal/modules/cjs/loader:1005:19)
    at require (node:internal/modules/cjs/helpers:102:18)
    at /data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:366:3
    at Array.forEach (<anonymous>)
    at Object.<anonymous> (/data/js-variants/multee/Clients/levelup/pouchdb/node_modules/mocha/bin/_mocha:365:10)
    at Module._compile (node:internal/modules/cjs/loader:1105:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)
    at Module.load (node:internal/modules/cjs/loader:981:32)
    at Module._load (node:internal/modules/cjs/loader:827:12)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:77:12)
    at node:internal/main/run_main_module:17:47
    ✓ test close-then-destroyed for coverage
************* run test done *************
pouchdb is testing ./VariantsDeps/levelup/variant1/levelup
************* npm unlink module *************

removed 1 package, changed 1 package, and audited 1032 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm unlink module done *************
************* npm unlink globally *************

removed 1 package, and audited 1 package in 1s

found 0 vulnerabilities
************* npm unlink module done *************
************* npm link globally *************

added 1 package, and audited 3 packages in 402ms

found 0 vulnerabilities
************* npm link globally done *************
************* npm link module *************

added 1 package, changed 1 package, and audited 1034 packages in 3s

64 packages are looking for funding
  run `npm fund` for details

41 vulnerabilities (1 low, 9 moderate, 25 high, 6 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
************* npm link module done *************
************* start run test *************

> pouchdb-monorepo@7.0.0-prerelease test
> bash bin/run-test.sh


> pouchdb-monorepo@7.0.0-prerelease build-node
> bash bin/build-node.sh


> pouchdb-monorepo@7.0.0-prerelease build-modules
> node bin/build-modules.js

Building pouchdb...
Building pouchdb-abstract-mapreduce...
Building pouchdb-adapter-http...
Building pouchdb-adapter-idb...
Building pouchdb-adapter-indexeddb...
Building pouchdb-adapter-leveldb...
Building pouchdb-adapter-leveldb-core...
Building pouchdb-adapter-localstorage...
Building pouchdb-adapter-memory...
Building pouchdb-adapter-utils...
Building pouchdb-binary-utils...
Building pouchdb-browser...
Building pouchdb-changes-filter...
Building pouchdb-checkpointer...
Building pouchdb-collate...
Building pouchdb-collections...
Building pouchdb-core...
Building pouchdb-errors...
Building pouchdb-fetch...
Building pouchdb-find...
Building pouchdb-for-coverage...
Building pouchdb-generate-replication-id...
Building pouchdb-json...
Building pouchdb-mapreduce...
Building pouchdb-mapreduce-utils...
Building pouchdb-md5...
Building pouchdb-merge...
Building pouchdb-node...
Building pouchdb-replication...
Building pouchdb-selector-core...
Building pouchdb-utils...
Building sublevel-pouchdb...
  ✓ wrote pouchdb-adapter-localstorage/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-localstorage/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-memory/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.js in vanilla mode
  ✓ wrote pouchdb-checkpointer/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.js in vanilla mode
  ✓ wrote pouchdb-errors/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.js in vanilla mode
  ✓ wrote pouchdb-generate-replication-id/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-http/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-adapter-leveldb-core/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-fetch/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-md5/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-changes-filter/lib/index.js in node mode
  ✓ wrote pouchdb-changes-filter/lib/index.es.js in node mode
  ✓ wrote pouchdb-collate/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collate/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-fetch/lib/index.js in node mode
  ✓ wrote pouchdb-fetch/lib/index.es.js in node mode
  ✓ wrote pouchdb-json/lib/index.js in vanilla mode
  ✓ wrote pouchdb-json/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-mapreduce-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-md5/lib/index.js in node mode
  ✓ wrote pouchdb-md5/lib/index.es.js in node mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.js in vanilla mode
  ✓ wrote pouchdb-abstract-mapreduce/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-idb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-indexeddb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-binary-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-utils/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-utils/lib/index.js in node mode
  ✓ wrote pouchdb-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-adapter-utils/lib/index.js in vanilla mode
  ✓ wrote pouchdb-adapter-utils/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-binary-utils/lib/index.js in node mode
  ✓ wrote pouchdb-binary-utils/lib/index.es.js in node mode
  ✓ wrote pouchdb-collections/lib/index.js in vanilla mode
  ✓ wrote pouchdb-collections/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.js in vanilla mode
  ✓ wrote pouchdb-merge/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-selector-core/lib/index.es.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.js in vanilla mode
  ✓ wrote sublevel-pouchdb/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-mapreduce/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-replication/lib/index.js in vanilla mode
  ✓ wrote pouchdb-replication/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-mapreduce/lib/index.js in node mode
  ✓ wrote pouchdb-mapreduce/lib/index.es.js in node mode
  ✓ wrote pouchdb-core/lib/index.js in vanilla mode
  ✓ wrote pouchdb-core/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-find/lib/index.js in node mode
  ✓ wrote pouchdb-find/lib/index.es.js in node mode
  ✓ wrote pouchdb-find/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-find/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index.es.js in node mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.js in browser mode
  ✓ wrote pouchdb-for-coverage/lib/index-browser.es.js in browser mode
  ✓ wrote pouchdb-browser/lib/index.js in vanilla mode
  ✓ wrote pouchdb-browser/lib/index.es.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.js in vanilla mode
  ✓ wrote pouchdb-node/lib/index.es.js in vanilla mode
  ✓ wrote packages/node_modules/pouchdb/lib/index.es.js
  ✓ wrote packages/node_modules/pouchdb/lib/index.js
Waiting for host to start .....
Host failed to start
************* run test done *************
