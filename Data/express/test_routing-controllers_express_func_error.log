11
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (30 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty
      ✓ handle - should process number parameters (1 ms)
      ✓ handle - undefined on empty object provided
      ✓ handle - null provided (13 ms)
    negative
      ✕ handle - throws error if the parameter is required (7 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (20 ms)
      ✓ post respond with proper status code, headers and body content (5 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (4 ms)
      ✓ route should work with regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (5 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (504 ms)
      ✓ should respond with 500 if promise failed (505 ms)
      ✓ should respond with 204 No Content when null returned in action (25 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (48 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (3 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (5 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (2 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (10 ms)
      ✓ post respond with proper status code, headers and body content (2 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (2 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (1 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (504 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (9 ms)
      ✓ custom interceptor class should replace returned content (3 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (2 ms)
      ✓ global interceptor class should replace returned content (3 ms)
      ✓ interceptors should support promises (1003 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (10 ms)
    ✓ @Res writing directly to the response should work (4 ms)
    ✓ @Param should give a param from route (3 ms)
    ✓ @Param multiple params should give a proper values from route (3 ms)
    ✓ @SessionParam without middleware (22 ms)
    ✓ @Session should return a value from session (10 ms)
    ✓ @Session(param) should allow to inject empty property (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (6 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (12 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (5 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (2 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (3 ms)
    ✓ @QueryParam should give a proper values from request query parameters (2 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (3 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (2 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (7 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (2 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (1 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (5 ms)
    ✓ @HeaderParam should fail with missing required params (3 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @CookieParam should give a proper values from request headers (2 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (4 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (11 ms)
    ✓ @Body should fail if required body was not provided (10 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (4 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (18 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (3 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (12 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (4 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFile when required is used files must be provided (6 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (5 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (63 ms)
    using custom container should be possible
      ✓ custom container (6 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (8 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (7 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (70 ms)
      ✓ with roles (14 ms)
      ✓ async (24 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (3 ms)
      ✓ with roles (3 ms)
      ✓ async (16 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (19 ms)
      ✓ with roles (4 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (5 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (3 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (11 ms)
      ✓ should return custom code when @OnNull (43 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (7 ms)
      ✓ should return custom code when @OnUndefined (9 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return response with custom headers when @Header is used (3 ms)
      ✓ should relocate to new location when @Location is used (3 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (32 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (13 ms)
      ✓ should fail (17 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (9 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (2 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (3 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (2 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (3 ms)
      ✓ should handle errors in custom middlewares (19 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (217 ms)
    should apply global options
      ✓ technical wrapper (5 ms)
    should apply local options
      ✓ technical wrapper (5 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (62 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (5 ms)
      should pass the valid param after validation
        ✓ succeed (4 ms)
        ✓ should contain param name on validation failed (14 ms)
    local options
      ✓ should apply local options (6 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (21 ms)
      ✓ should call global error handler middleware (21 ms)
      ✓ should call global error handler middleware (4 ms)
      ✓ should call error handler middleware if used (2 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (3 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (2 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (10 ms)
    ✓ should build meta if the only derivative controller is given (1 ms)
    ✓ should build meta if the only autonomous controller is given (1 ms)
    ✓ should build meta both when autonomous and derivative controllers are given (1 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (18 ms)
      ✓ when controller transform is enabled (5 ms)
      ✓ when controller transform is disabled (3 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (75 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (4 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (4 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (8 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (8 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (2 ms)
      ✓ should return 400 from required paramOptions (13 ms)
      ✓ should return nullResultCode from defaults config (3 ms)
      ✓ should return status code from OnUndefined annotation (2 ms)
      ✓ should mark arg optional from QueryParam annotation (4 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (21 ms)
    ✓ should override controller options with action transformRequest option (5 ms)
    ✓ should override controller options with action transformResponse option (3 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (29 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (58 ms)
      ✓ get should respond with proper status code, headers and body content (4 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (4 ms)
      ✓ wrong route should respond with 404 error (4 ms)
      ✓ wrong route should respond with 404 error (2 ms)
      ✓ wrong route should respond with 404 error (3 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (25 ms)
      ✓ using override (3 ms)
      ✓ using original (4 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (21 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (3 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (21 ms)
      ✓ should call global error handler middleware (19 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (36 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (22 ms)
      ✓ should send raw binary data from Buffer (4 ms)
      ✓ should send raw binary data from UIntArray (2 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (2 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.849 s, estimated 13 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (26 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty
      ✓ handle - should process number parameters (1 ms)
      ✓ handle - undefined on empty object provided
      ✓ handle - null provided (16 ms)
    negative
      ✕ handle - throws error if the parameter is required (8 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (20 ms)
      ✓ post respond with proper status code, headers and body content (5 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (5 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (505 ms)
      ✓ should respond with 500 if promise failed (504 ms)
      ✓ should respond with 204 No Content when null returned in action (5 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (29 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (3 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (4 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (3 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (9 ms)
      ✓ post respond with proper status code, headers and body content (2 ms)
      ✓ put respond with proper status code, headers and body content (2 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (3 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (504 ms)
      ✓ should respond with 500 if promise failed (505 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (9 ms)
      ✓ custom interceptor class should replace returned content (3 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (2 ms)
      ✓ global interceptor class should replace returned content (2 ms)
      ✓ interceptors should support promises (1004 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (10 ms)
    ✓ @Res writing directly to the response should work (4 ms)
    ✓ @Param should give a param from route (3 ms)
    ✓ @Param multiple params should give a proper values from route (2 ms)
    ✓ @SessionParam without middleware (22 ms)
    ✓ @Session should return a value from session (10 ms)
    ✓ @Session(param) should allow to inject empty property (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (6 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (5 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (11 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (2 ms)
    ✓ @QueryParam should give a proper values from request query parameters (2 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (3 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (3 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (7 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (2 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (3 ms)
    ✓ @HeaderParam should fail with missing required params (3 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @CookieParam should give a proper values from request headers (3 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (5 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (17 ms)
    ✓ @Body should fail if required body was not provided (9 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (4 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (7 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (29 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (5 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (17 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (4 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFile when required is used files must be provided (6 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (4 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (64 ms)
    should apply global options
      ✓ technical wrapper (5 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (59 ms)
      ✓ with roles (14 ms)
      ✓ async (25 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (4 ms)
      ✓ with roles (3 ms)
      ✓ async (14 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (41 ms)
      ✓ with roles (3 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (4 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (3 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (33 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (10 ms)
      ✓ should fail (17 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (11 ms)
      ✓ should return custom code when @OnNull (30 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (7 ms)
      ✓ should return custom code when @OnUndefined (8 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return response with custom headers when @Header is used (4 ms)
      ✓ should relocate to new location when @Location is used (2 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (60 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (6 ms)
      should pass the valid param after validation
        ✓ succeed (4 ms)
        ✓ should contain param name on validation failed (14 ms)
    local options
      ✓ should apply local options (6 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (17 ms)
      ✓ should call global error handler middleware (29 ms)
      ✓ should call global error handler middleware (7 ms)
      ✓ should call error handler middleware if used (5 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (5 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (21 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (59 ms)
      ✓ get should respond with proper status code, headers and body content (5 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (5 ms)
      ✓ wrong route should respond with 404 error (4 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (2 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (60 ms)
    using custom container should be possible
      ✓ custom container (6 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (8 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (8 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (19 ms)
    ✓ should override controller options with action transformRequest option (5 ms)
    ✓ should override controller options with action transformResponse option (3 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (8 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (3 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (3 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (3 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (3 ms)
      ✓ should handle errors in custom middlewares (21 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (13 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (22 ms)
      ✓ should call global error handler middleware (16 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (79 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (4 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (3 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (6 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (11 ms)
    ✓ should build meta if the only derivative controller is given (2 ms)
    ✓ should build meta if the only autonomous controller is given
    ✓ should build meta both when autonomous and derivative controllers are given (1 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (9 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (4 ms)
      ✓ should return 400 from required paramOptions (16 ms)
      ✓ should return nullResultCode from defaults config (3 ms)
      ✓ should return status code from OnUndefined annotation (2 ms)
      ✓ should mark arg optional from QueryParam annotation (4 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (19 ms)
      ✓ when controller transform is enabled (4 ms)
      ✓ when controller transform is disabled (3 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (33 ms)
      ✓ using override (4 ms)
      ✓ using original (4 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (35 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (21 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (2 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (23 ms)
      ✓ should send raw binary data from Buffer (3 ms)
      ✓ should send raw binary data from UIntArray (3 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (2 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.807 s, estimated 13 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (27 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty (1 ms)
      ✓ handle - should process number parameters
      ✓ handle - undefined on empty object provided
      ✓ handle - null provided (13 ms)
    negative
      ✕ handle - throws error if the parameter is required (8 ms)
      ✓ handle - throws error if the parameter is required, type file provided (5 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (20 ms)
      ✓ post respond with proper status code, headers and body content (4 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (2 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (5 ms)
      ✓ route should work with string regexp parameter (9 ms)
      ✓ should respond with 404 when regexp does not match (3 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (504 ms)
      ✓ should respond with 204 No Content when null returned in action (6 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (31 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (3 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (4 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (2 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (10 ms)
      ✓ post respond with proper status code, headers and body content (2 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (2 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (3 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (1 ms)
      ✓ should return result from a promise (504 ms)
      ✓ should respond with 500 if promise failed (505 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (9 ms)
      ✓ custom interceptor class should replace returned content (3 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (2 ms)
      ✓ global interceptor class should replace returned content (3 ms)
      ✓ interceptors should support promises (1003 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (10 ms)
    ✓ @Res writing directly to the response should work (3 ms)
    ✓ @Param should give a param from route (4 ms)
    ✓ @Param multiple params should give a proper values from route (2 ms)
    ✓ @SessionParam without middleware (22 ms)
    ✓ @Session should return a value from session (13 ms)
    ✓ @Session(param) should allow to inject empty property (4 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (11 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (6 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (4 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (11 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (2 ms)
    ✓ @QueryParam should give a proper values from request query parameters (2 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (3 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (2 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (8 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (2 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (2 ms)
    ✓ @HeaderParam should fail with missing required params (3 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (3 ms)
    ✓ @CookieParam should give a proper values from request headers (3 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (3 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (12 ms)
    ✓ @Body should fail if required body was not provided (6 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (4 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (20 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (4 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (11 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (5 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (4 ms)
    ✓ @UploadedFile when required is used files must be provided (7 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (4 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (5 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (73 ms)
      ✓ with roles (14 ms)
      ✓ async (24 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (3 ms)
      ✓ with roles (4 ms)
      ✓ async (12 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (19 ms)
      ✓ with roles (3 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (5 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (3 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (59 ms)
      ✓ get should respond with proper status code, headers and body content (4 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (4 ms)
      ✓ wrong route should respond with 404 error (5 ms)
      ✓ wrong route should respond with 404 error (4 ms)
      ✓ wrong route should respond with 404 error (4 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (11 ms)
      ✓ should return custom code when @OnNull (40 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (7 ms)
      ✓ should return custom code when @OnUndefined (8 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return response with custom headers when @Header is used (3 ms)
      ✓ should relocate to new location when @Location is used (16 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (9 ms)
      ✓ should call global error handler middleware (35 ms)
      ✓ should call global error handler middleware (4 ms)
      ✓ should call error handler middleware if used (2 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (2 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (3 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (64 ms)
    using custom container should be possible
      ✓ custom container (6 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (8 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (9 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (57 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (26 ms)
      ✓ should fail (48 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (66 ms)
    should apply global options
      ✓ technical wrapper (5 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (26 ms)
      ✓ using override (4 ms)
      ✓ using original (3 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (78 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (4 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (3 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (6 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (61 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (5 ms)
      should pass the valid param after validation
        ✓ succeed (4 ms)
        ✓ should contain param name on validation failed (16 ms)
    local options
      ✓ should apply local options (5 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (11 ms)
    ✓ should build meta if the only derivative controller is given (2 ms)
    ✓ should build meta if the only autonomous controller is given (1 ms)
    ✓ should build meta both when autonomous and derivative controllers are given

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (18 ms)
      ✓ when controller transform is enabled (5 ms)
      ✓ when controller transform is disabled (3 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (8 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (2 ms)
      ✓ should return 400 from required paramOptions (16 ms)
      ✓ should return nullResultCode from defaults config (3 ms)
      ✓ should return status code from OnUndefined annotation (2 ms)
      ✓ should mark arg optional from QueryParam annotation (4 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (21 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (3 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (2 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (3 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (2 ms)
      ✓ should handle errors in custom middlewares (23 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (18 ms)
    ✓ should override controller options with action transformRequest option (5 ms)
    ✓ should override controller options with action transformResponse option (3 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (37 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (27 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (21 ms)
      ✓ should send raw binary data from Buffer (2 ms)
      ✓ should send raw binary data from UIntArray (2 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (24 ms)
      ✓ should call global error handler middleware (18 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (22 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (2 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (1 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.865 s, estimated 13 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (32 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty (1 ms)
      ✓ handle - should process number parameters
      ✓ handle - undefined on empty object provided (1 ms)
      ✓ handle - null provided (9 ms)
    negative
      ✕ handle - throws error if the parameter is required (12 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (19 ms)
      ✓ post respond with proper status code, headers and body content (5 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (4 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (4 ms)
      ✓ route should work with parameter (4 ms)
      ✓ route should work with regexp parameter (18 ms)
      ✓ should respond with 404 when regexp does not match (7 ms)
      ✓ route should work with string regexp parameter (8 ms)
      ✓ should respond with 404 when regexp does not match (3 ms)
      ✓ should return result from a promise (518 ms)
      ✓ should respond with 500 if promise failed (505 ms)
      ✓ should respond with 204 No Content when null returned in action (5 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (31 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (3 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (4 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (3 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (10 ms)
      ✓ post respond with proper status code, headers and body content (3 ms)
      ✓ put respond with proper status code, headers and body content (2 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (2 ms)
      ✓ route should work with regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (504 ms)
      ✓ should respond with 500 if promise failed (505 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (9 ms)
      ✓ custom interceptor class should replace returned content (2 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (3 ms)
      ✓ global interceptor class should replace returned content (2 ms)
      ✓ interceptors should support promises (1004 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (10 ms)
    ✓ @Res writing directly to the response should work (3 ms)
    ✓ @Param should give a param from route (4 ms)
    ✓ @Param multiple params should give a proper values from route (2 ms)
    ✓ @SessionParam without middleware (22 ms)
    ✓ @Session should return a value from session (10 ms)
    ✓ @Session(param) should allow to inject empty property (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (6 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (4 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (11 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (3 ms)
    ✓ @QueryParam should give a proper values from request query parameters (2 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (3 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (2 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (8 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (2 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (2 ms)
    ✓ @HeaderParam should fail with missing required params (3 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (3 ms)
    ✓ @CookieParam should give a proper values from request headers (3 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (3 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (12 ms)
    ✓ @Body should fail if required body was not provided (6 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (11 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (21 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (4 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (12 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (5 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (5 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFile when required is used files must be provided (6 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (4 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (6 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (65 ms)
    should apply global options
      ✓ technical wrapper (5 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (18 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (8 ms)
      ✓ should fail (42 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (73 ms)
      ✓ with roles (14 ms)
      ✓ async (24 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (4 ms)
      ✓ with roles (3 ms)
      ✓ async (13 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (20 ms)
      ✓ with roles (4 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (4 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (11 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (11 ms)
      ✓ should return custom code when @OnNull (30 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (6 ms)
      ✓ should return custom code when @OnUndefined (9 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return response with custom headers when @Header is used (3 ms)
      ✓ should relocate to new location when @Location is used (3 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (70 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (8 ms)
      should pass the valid param after validation
        ✓ succeed (4 ms)
        ✓ should contain param name on validation failed (14 ms)
    local options
      ✓ should apply local options (6 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (82 ms)
      ✓ get should respond with proper status code, headers and body content (13 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (16 ms)
      ✓ wrong route should respond with 404 error (13 ms)
      ✓ wrong route should respond with 404 error (13 ms)
      ✓ wrong route should respond with 404 error (6 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (23 ms)
      ✓ should call global error handler middleware (18 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (61 ms)
    using custom container should be possible
      ✓ custom container (5 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (8 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (8 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (8 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (3 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (2 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (3 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (2 ms)
      ✓ should handle errors in custom middlewares (22 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (19 ms)
    ✓ should override controller options with action transformRequest option (5 ms)
    ✓ should override controller options with action transformResponse option (3 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (10 ms)
    ✓ should build meta if the only derivative controller is given (2 ms)
    ✓ should build meta if the only autonomous controller is given (1 ms)
    ✓ should build meta both when autonomous and derivative controllers are given

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (81 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (3 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (3 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (6 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (9 ms)
      ✓ should call global error handler middleware (21 ms)
      ✓ should call global error handler middleware (3 ms)
      ✓ should call error handler middleware if used (3 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (2 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (3 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (21 ms)
      ✓ when controller transform is enabled (5 ms)
      ✓ when controller transform is disabled (4 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (13 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (7 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (2 ms)
      ✓ should return 400 from required paramOptions (15 ms)
      ✓ should return nullResultCode from defaults config (3 ms)
      ✓ should return status code from OnUndefined annotation (3 ms)
      ✓ should mark arg optional from QueryParam annotation (4 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (25 ms)
      ✓ using override (3 ms)
      ✓ using original (4 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (21 ms)
      ✓ should send raw binary data from Buffer (2 ms)
      ✓ should send raw binary data from UIntArray (2 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (37 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (25 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (3 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (4 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (1 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        13.042 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (27 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty
      ✓ handle - should process number parameters (1 ms)
      ✓ handle - undefined on empty object provided
      ✓ handle - null provided (16 ms)
    negative
      ✕ handle - throws error if the parameter is required (7 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (23 ms)
      ✓ post respond with proper status code, headers and body content (7 ms)
      ✓ put respond with proper status code, headers and body content (4 ms)
      ✓ patch respond with proper status code, headers and body content (4 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (3 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (5 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (505 ms)
      ✓ should respond with 500 if promise failed (504 ms)
      ✓ should respond with 204 No Content when null returned in action (5 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (31 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (2 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (4 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (3 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (10 ms)
      ✓ post respond with proper status code, headers and body content (2 ms)
      ✓ put respond with proper status code, headers and body content (2 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (6 ms)
      ✓ route should work with string regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (505 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (26 ms)
      ✓ custom interceptor class should replace returned content (3 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (3 ms)
      ✓ global interceptor class should replace returned content (3 ms)
      ✓ interceptors should support promises (1004 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (19 ms)
    ✓ @Res writing directly to the response should work (4 ms)
    ✓ @Param should give a param from route (3 ms)
    ✓ @Param multiple params should give a proper values from route (2 ms)
    ✓ @SessionParam without middleware (23 ms)
    ✓ @Session should return a value from session (10 ms)
    ✓ @Session(param) should allow to inject empty property (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (6 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (4 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (3 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (2 ms)
    ✓ @QueryParam should give a proper values from request query parameters (10 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (3 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (9 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (2 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (7 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (2 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (6 ms)
    ✓ @HeaderParam should fail with missing required params (2 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (3 ms)
    ✓ @CookieParam should give a proper values from request headers (2 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (3 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (12 ms)
    ✓ @Body should fail if required body was not provided (6 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (4 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (20 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (4 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (12 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (5 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (5 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFile when required is used files must be provided (6 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (4 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (68 ms)
      ✓ with roles (13 ms)
      ✓ async (24 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (4 ms)
      ✓ with roles (3 ms)
      ✓ async (13 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (25 ms)
      ✓ with roles (4 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (4 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (3 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (21 ms)
      ✓ should call global error handler middleware (17 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (38 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (14 ms)
      ✓ should fail (16 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (136 ms)
      ✓ get should respond with proper status code, headers and body content (4 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (3 ms)
      ✓ wrong route should respond with 404 error (5 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (2 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (24 ms)
      ✓ should return custom code when @OnNull (31 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (7 ms)
      ✓ should return custom code when @OnUndefined (8 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return response with custom headers when @Header is used (3 ms)
      ✓ should relocate to new location when @Location is used (3 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (10 ms)
    ✓ should build meta if the only derivative controller is given (2 ms)
    ✓ should build meta if the only autonomous controller is given (1 ms)
    ✓ should build meta both when autonomous and derivative controllers are given

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (14 ms)
      ✓ should call global error handler middleware (47 ms)
      ✓ should call global error handler middleware (22 ms)
      ✓ should call error handler middleware if used (7 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (11 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (9 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (79 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (5 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (4 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (6 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (45 ms)
    should apply global options
      ✓ technical wrapper (4 ms)
    should apply local options
      ✓ technical wrapper (15 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (57 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (6 ms)
      should pass the valid param after validation
        ✓ succeed (4 ms)
        ✓ should contain param name on validation failed (14 ms)
    local options
      ✓ should apply local options (6 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (55 ms)
    using custom container should be possible
      ✓ custom container (6 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (8 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (9 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (18 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (3 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (26 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (2 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (3 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (2 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (2 ms)
      ✓ should handle errors in custom middlewares (28 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (32 ms)
      ✓ when controller transform is enabled (5 ms)
      ✓ when controller transform is disabled (3 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (36 ms)
    ✓ should override controller options with action transformRequest option (4 ms)
    ✓ should override controller options with action transformResponse option (3 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (22 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (2 ms)
      ✓ should return 400 from required paramOptions (16 ms)
      ✓ should return nullResultCode from defaults config (3 ms)
      ✓ should return status code from OnUndefined annotation (2 ms)
      ✓ should mark arg optional from QueryParam annotation (4 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (47 ms)
      ✓ should render a template with given variables and locals variables (7 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (14 ms)
      ✓ using override (3 ms)
      ✓ using original (18 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (8 ms)
      ✓ should send raw binary data from Buffer (2 ms)
      ✓ should send raw binary data from UIntArray (3 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (24 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (1 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.779 s, estimated 13 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (28 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty
      ✓ handle - should process number parameters
      ✓ handle - undefined on empty object provided (5 ms)
      ✓ handle - null provided (14 ms)
    negative
      ✕ handle - throws error if the parameter is required (12 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (20 ms)
      ✓ post respond with proper status code, headers and body content (5 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (8 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (4 ms)
      ✓ route should work with regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (505 ms)
      ✓ should respond with 500 if promise failed (504 ms)
      ✓ should respond with 204 No Content when null returned in action (15 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (21 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (3 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (4 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (2 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (10 ms)
      ✓ post respond with proper status code, headers and body content (3 ms)
      ✓ put respond with proper status code, headers and body content (2 ms)
      ✓ patch respond with proper status code, headers and body content (2 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (1 ms)
      ✓ should return result from a promise (504 ms)
      ✓ should respond with 500 if promise failed (505 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (9 ms)
      ✓ custom interceptor class should replace returned content (3 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (2 ms)
      ✓ global interceptor class should replace returned content (3 ms)
      ✓ interceptors should support promises (1004 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (10 ms)
    ✓ @Res writing directly to the response should work (4 ms)
    ✓ @Param should give a param from route (3 ms)
    ✓ @Param multiple params should give a proper values from route (3 ms)
    ✓ @SessionParam without middleware (22 ms)
    ✓ @Session should return a value from session (10 ms)
    ✓ @Session(param) should allow to inject empty property (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (6 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (12 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (5 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (2 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (3 ms)
    ✓ @QueryParam should give a proper values from request query parameters (2 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (4 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (2 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (7 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (3 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (1 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (1 ms)
    ✓ @HeaderParam should fail with invalid request options (3 ms)
    ✓ @HeaderParam should fail with missing required params (3 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (3 ms)
    ✓ @CookieParam should give a proper values from request headers (3 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (3 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (12 ms)
    ✓ @Body should fail if required body was not provided (6 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (8 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (17 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (4 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (11 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (4 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFile when required is used files must be provided (7 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (4 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (81 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (3 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (3 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (6 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (72 ms)
      ✓ with roles (14 ms)
      ✓ async (23 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (4 ms)
      ✓ with roles (3 ms)
      ✓ async (13 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (20 ms)
      ✓ with roles (4 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (6 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (5 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (63 ms)
      ✓ get should respond with proper status code, headers and body content (5 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (4 ms)
      ✓ wrong route should respond with 404 error (4 ms)
      ✓ wrong route should respond with 404 error (2 ms)
      ✓ wrong route should respond with 404 error (2 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (9 ms)
      ✓ should call global error handler middleware (20 ms)
      ✓ should call global error handler middleware (3 ms)
      ✓ should call error handler middleware if used (3 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (2 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (3 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (18 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (13 ms)
      ✓ should fail (28 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (43 ms)
      ✓ should return custom code when @OnNull (75 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (32 ms)
      ✓ should return custom code when @OnUndefined (102 ms)
      ✓ should return content-type in the response when @ContentType is used (12 ms)
      ✓ should return content-type in the response when @ContentType is used (3 ms)
      ✓ should return response with custom headers when @Header is used (9 ms)
      ✓ should relocate to new location when @Location is used (2 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (22 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (3 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (3 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (2 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (3 ms)
      ✓ should handle errors in custom middlewares (18 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (25 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (58 ms)
    should apply global options
      ✓ technical wrapper (4 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (63 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (5 ms)
      should pass the valid param after validation
        ✓ succeed (4 ms)
        ✓ should contain param name on validation failed (20 ms)
    local options
      ✓ should apply local options (5 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (14 ms)
      ✓ using override (4 ms)
      ✓ using original (4 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (11 ms)
    ✓ should build meta if the only derivative controller is given (1 ms)
    ✓ should build meta if the only autonomous controller is given (1 ms)
    ✓ should build meta both when autonomous and derivative controllers are given (1 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (19 ms)
    ✓ should override controller options with action transformRequest option (4 ms)
    ✓ should override controller options with action transformResponse option (3 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (8 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (2 ms)
      ✓ should return 400 from required paramOptions (16 ms)
      ✓ should return nullResultCode from defaults config (3 ms)
      ✓ should return status code from OnUndefined annotation (2 ms)
      ✓ should mark arg optional from QueryParam annotation (4 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (19 ms)
      ✓ when controller transform is enabled (5 ms)
      ✓ when controller transform is disabled (3 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (65 ms)
    using custom container should be possible
      ✓ custom container (6 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (7 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (8 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (22 ms)
      ✓ should call global error handler middleware (18 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (35 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (21 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (2 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (22 ms)
      ✓ should send raw binary data from Buffer (3 ms)
      ✓ should send raw binary data from UIntArray (8 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (2 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.856 s, estimated 13 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (27 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty (1 ms)
      ✓ handle - should process number parameters
      ✓ handle - undefined on empty object provided (1 ms)
      ✓ handle - null provided (10 ms)
    negative
      ✕ handle - throws error if the parameter is required (7 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (20 ms)
      ✓ post respond with proper status code, headers and body content (5 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (3 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (504 ms)
      ✓ should respond with 204 No Content when null returned in action (9 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (45 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (3 ms)
      ✓ should respond with 200 and text/html even in json controller's method (12 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (4 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (2 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (10 ms)
      ✓ post respond with proper status code, headers and body content (2 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (2 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (3 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (504 ms)
      ✓ should respond with 500 if promise failed (505 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (23 ms)
      ✓ custom interceptor class should replace returned content (3 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (3 ms)
      ✓ global interceptor class should replace returned content (3 ms)
      ✓ interceptors should support promises (1003 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (10 ms)
    ✓ @Res writing directly to the response should work (4 ms)
    ✓ @Param should give a param from route (3 ms)
    ✓ @Param multiple params should give a proper values from route (3 ms)
    ✓ @SessionParam without middleware (28 ms)
    ✓ @Session should return a value from session (11 ms)
    ✓ @Session(param) should allow to inject empty property (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (6 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (4 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (2 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (11 ms)
    ✓ @QueryParam should give a proper values from request query parameters (2 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (3 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (2 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (8 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (2 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (3 ms)
    ✓ @HeaderParam should fail with missing required params (2 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (3 ms)
    ✓ @CookieParam should give a proper values from request headers (3 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (3 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (12 ms)
    ✓ @Body should fail if required body was not provided (6 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (5 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (21 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (3 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (12 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (4 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFile when required is used files must be provided (6 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (5 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (31 ms)
      ✓ should return custom code when @OnNull (31 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (7 ms)
      ✓ should return custom code when @OnUndefined (11 ms)
      ✓ should return content-type in the response when @ContentType is used (3 ms)
      ✓ should return content-type in the response when @ContentType is used (3 ms)
      ✓ should return response with custom headers when @Header is used (7 ms)
      ✓ should relocate to new location when @Location is used (3 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (69 ms)
      ✓ with roles (14 ms)
      ✓ async (24 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (4 ms)
      ✓ with roles (4 ms)
      ✓ async (13 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (21 ms)
      ✓ with roles (5 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (7 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (21 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (33 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (14 ms)
      ✓ should fail (17 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (49 ms)
      ✓ should call global error handler middleware (27 ms)
      ✓ should call global error handler middleware (13 ms)
      ✓ should call error handler middleware if used (13 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (8 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (4 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (20 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (3 ms)
      ✓ should return 400 from required paramOptions (21 ms)
      ✓ should return nullResultCode from defaults config (3 ms)
      ✓ should return status code from OnUndefined annotation (3 ms)
      ✓ should mark arg optional from QueryParam annotation (4 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (23 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (4 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (2 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (3 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (3 ms)
      ✓ should handle errors in custom middlewares (29 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (87 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (9 ms)
      should pass the valid param after validation
        ✓ succeed (7 ms)
        ✓ should contain param name on validation failed (18 ms)
    local options
      ✓ should apply local options (8 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (60 ms)
    should apply global options
      ✓ technical wrapper (16 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (80 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (4 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (3 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (6 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (70 ms)
    using custom container should be possible
      ✓ custom container (7 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (11 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (8 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (10 ms)
    ✓ should build meta if the only derivative controller is given (2 ms)
    ✓ should build meta if the only autonomous controller is given (1 ms)
    ✓ should build meta both when autonomous and derivative controllers are given

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (19 ms)
      ✓ when controller transform is enabled (5 ms)
      ✓ when controller transform is disabled (3 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (21 ms)
    ✓ should override controller options with action transformRequest option (5 ms)
    ✓ should override controller options with action transformResponse option (2 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (23 ms)
      ✓ should call global error handler middleware (17 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (65 ms)
      ✓ get should respond with proper status code, headers and body content (4 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (3 ms)
      ✓ wrong route should respond with 404 error (4 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (2 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (36 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (28 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (28 ms)
      ✓ using override (3 ms)
      ✓ using original (4 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (22 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (3 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (22 ms)
      ✓ should send raw binary data from Buffer (4 ms)
      ✓ should send raw binary data from UIntArray (2 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (2 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        13.179 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (28 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty
      ✓ handle - should process number parameters (1 ms)
      ✓ handle - undefined on empty object provided
      ✓ handle - null provided (13 ms)
    negative
      ✕ handle - throws error if the parameter is required (7 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (20 ms)
      ✓ post respond with proper status code, headers and body content (5 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (3 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (5 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (504 ms)
      ✓ should respond with 500 if promise failed (506 ms)
      ✓ should respond with 204 No Content when null returned in action (5 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (30 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (3 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (5 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (2 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (10 ms)
      ✓ post respond with proper status code, headers and body content (3 ms)
      ✓ put respond with proper status code, headers and body content (2 ms)
      ✓ patch respond with proper status code, headers and body content (2 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (3 ms)
      ✓ route should work with parameter (2 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (7 ms)
      ✓ route should work with string regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (505 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (21 ms)
      ✓ custom interceptor class should replace returned content (3 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (2 ms)
      ✓ global interceptor class should replace returned content (3 ms)
      ✓ interceptors should support promises (1004 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (10 ms)
    ✓ @Res writing directly to the response should work (4 ms)
    ✓ @Param should give a param from route (3 ms)
    ✓ @Param multiple params should give a proper values from route (2 ms)
    ✓ @SessionParam without middleware (22 ms)
    ✓ @Session should return a value from session (10 ms)
    ✓ @Session(param) should allow to inject empty property (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (6 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (4 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (3 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (10 ms)
    ✓ @QueryParam should give a proper values from request query parameters (2 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (3 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (2 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (8 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (2 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (3 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (8 ms)
    ✓ @HeaderParam should fail with missing required params (3 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @CookieParam should give a proper values from request headers (3 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (5 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (11 ms)
    ✓ @Body should fail if required body was not provided (7 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (4 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (22 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (3 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (12 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (4 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFile when required is used files must be provided (6 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (5 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (80 ms)
    should apply global options
      ✓ technical wrapper (9 ms)
    should apply local options
      ✓ technical wrapper (8 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (8 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (2 ms)
      ✓ should return 400 from required paramOptions (16 ms)
      ✓ should return nullResultCode from defaults config (3 ms)
      ✓ should return status code from OnUndefined annotation (2 ms)
      ✓ should mark arg optional from QueryParam annotation (7 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (71 ms)
      ✓ with roles (14 ms)
      ✓ async (24 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (4 ms)
      ✓ with roles (4 ms)
      ✓ async (13 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (20 ms)
      ✓ with roles (3 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (5 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (16 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (22 ms)
      ✓ should call global error handler middleware (21 ms)
      ✓ should call global error handler middleware (3 ms)
      ✓ should call error handler middleware if used (3 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (3 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (2 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (37 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (7 ms)
      ✓ should fail (26 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (75 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (9 ms)
      should pass the valid param after validation
        ✓ succeed (8 ms)
        ✓ should contain param name on validation failed (18 ms)
    local options
      ✓ should apply local options (7 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (12 ms)
      ✓ should return custom code when @OnNull (30 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (7 ms)
      ✓ should return custom code when @OnUndefined (25 ms)
      ✓ should return content-type in the response when @ContentType is used (3 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return response with custom headers when @Header is used (3 ms)
      ✓ should relocate to new location when @Location is used (2 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (19 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (3 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (2 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (2 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (2 ms)
      ✓ should handle errors in custom middlewares (20 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (65 ms)
    using custom container should be possible
      ✓ custom container (6 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (8 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (7 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (22 ms)
      ✓ should call global error handler middleware (17 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (74 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (4 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (3 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (6 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (32 ms)
      ✓ when controller transform is enabled (4 ms)
      ✓ when controller transform is disabled (4 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (33 ms)
    ✓ should override controller options with action transformRequest option (6 ms)
    ✓ should override controller options with action transformResponse option (3 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (18 ms)
    ✓ should build meta if the only derivative controller is given (3 ms)
    ✓ should build meta if the only autonomous controller is given (1 ms)
    ✓ should build meta both when autonomous and derivative controllers are given (1 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (13 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (59 ms)
      ✓ get should respond with proper status code, headers and body content (4 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (4 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (2 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (26 ms)
      ✓ using override (4 ms)
      ✓ using original (4 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (37 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (21 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (3 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (22 ms)
      ✓ should send raw binary data from Buffer (4 ms)
      ✓ should send raw binary data from UIntArray (2 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (1 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.887 s, estimated 14 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (28 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty
      ✓ handle - should process number parameters
      ✓ handle - undefined on empty object provided
      ✓ handle - null provided (13 ms)
    negative
      ✕ handle - throws error if the parameter is required (11 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (19 ms)
      ✓ post respond with proper status code, headers and body content (5 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (5 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (505 ms)
      ✓ should respond with 500 if promise failed (504 ms)
      ✓ should respond with 204 No Content when null returned in action (5 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (30 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (3 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (4 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (2 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (10 ms)
      ✓ post respond with proper status code, headers and body content (3 ms)
      ✓ put respond with proper status code, headers and body content (2 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (504 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (9 ms)
      ✓ custom interceptor class should replace returned content (2 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (3 ms)
      ✓ global interceptor class should replace returned content (2 ms)
      ✓ interceptors should support promises (1005 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (10 ms)
    ✓ @Res writing directly to the response should work (4 ms)
    ✓ @Param should give a param from route (3 ms)
    ✓ @Param multiple params should give a proper values from route (2 ms)
    ✓ @SessionParam without middleware (23 ms)
    ✓ @Session should return a value from session (10 ms)
    ✓ @Session(param) should allow to inject empty property (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (6 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (4 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (12 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (2 ms)
    ✓ @QueryParam should give a proper values from request query parameters (3 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (4 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (1 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (3 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (7 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (2 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (2 ms)
    ✓ @HeaderParam should fail with missing required params (5 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @CookieParam should give a proper values from request headers (3 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (4 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (11 ms)
    ✓ @Body should fail if required body was not provided (6 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (4 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (20 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (4 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (11 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (5 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (4 ms)
    ✓ @UploadedFile when required is used files must be provided (7 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (4 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (6 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (11 ms)
      ✓ should return custom code when @OnNull (30 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (7 ms)
      ✓ should return custom code when @OnUndefined (14 ms)
      ✓ should return content-type in the response when @ContentType is used (3 ms)
      ✓ should return content-type in the response when @ContentType is used (3 ms)
      ✓ should return response with custom headers when @Header is used (6 ms)
      ✓ should relocate to new location when @Location is used (3 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (70 ms)
      ✓ with roles (14 ms)
      ✓ async (24 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (4 ms)
      ✓ with roles (3 ms)
      ✓ async (14 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (19 ms)
      ✓ with roles (4 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (4 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (15 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (21 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (2 ms)
      ✓ should return 400 from required paramOptions (16 ms)
      ✓ should return nullResultCode from defaults config (3 ms)
      ✓ should return status code from OnUndefined annotation (2 ms)
      ✓ should mark arg optional from QueryParam annotation (5 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (67 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (5 ms)
      should pass the valid param after validation
        ✓ succeed (4 ms)
        ✓ should contain param name on validation failed (16 ms)
    local options
      ✓ should apply local options (5 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (64 ms)
    should apply global options
      ✓ technical wrapper (5 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (106 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (62 ms)
      ✓ should fail (17 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (25 ms)
      ✓ should call global error handler middleware (18 ms)
      ✓ should call global error handler middleware (4 ms)
      ✓ should call error handler middleware if used (4 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (4 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (3 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (10 ms)
    ✓ should build meta if the only derivative controller is given (2 ms)
    ✓ should build meta if the only autonomous controller is given (1 ms)
    ✓ should build meta both when autonomous and derivative controllers are given

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (8 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (3 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (2 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (3 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (2 ms)
      ✓ should handle errors in custom middlewares (23 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (19 ms)
    ✓ should override controller options with action transformRequest option (4 ms)
    ✓ should override controller options with action transformResponse option (3 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (60 ms)
    using custom container should be possible
      ✓ custom container (5 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (8 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (9 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (86 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (3 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (4 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (6 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (36 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (34 ms)
      ✓ when controller transform is enabled (5 ms)
      ✓ when controller transform is disabled (3 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (84 ms)
      ✓ get should respond with proper status code, headers and body content (4 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (3 ms)
      ✓ wrong route should respond with 404 error (4 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (2 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (27 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (35 ms)
      ✓ using override (4 ms)
      ✓ using original (4 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (22 ms)
      ✓ should send raw binary data from Buffer (3 ms)
      ✓ should send raw binary data from UIntArray (2 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (23 ms)
      ✓ should call global error handler middleware (18 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (23 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (2 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (2 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.895 s, estimated 13 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (32 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty
      ✓ handle - should process number parameters
      ✓ handle - undefined on empty object provided
      ✓ handle - null provided (10 ms)
    negative
      ✕ handle - throws error if the parameter is required (7 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (20 ms)
      ✓ post respond with proper status code, headers and body content (4 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (6 ms)
      ✓ route should work with string regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (513 ms)
      ✓ should respond with 500 if promise failed (505 ms)
      ✓ should respond with 204 No Content when null returned in action (5 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (20 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (3 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (4 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (2 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (10 ms)
      ✓ post respond with proper status code, headers and body content (3 ms)
      ✓ put respond with proper status code, headers and body content (2 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (504 ms)
      ✓ should respond with 500 if promise failed (504 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (9 ms)
      ✓ custom interceptor class should replace returned content (3 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (2 ms)
      ✓ global interceptor class should replace returned content (3 ms)
      ✓ interceptors should support promises (1003 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (17 ms)
    ✓ @Res writing directly to the response should work (6 ms)
    ✓ @Param should give a param from route (5 ms)
    ✓ @Param multiple params should give a proper values from route (4 ms)
    ✓ @SessionParam without middleware (32 ms)
    ✓ @Session should return a value from session (10 ms)
    ✓ @Session(param) should allow to inject empty property (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (16 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (5 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (2 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (3 ms)
    ✓ @QueryParam should give a proper values from request query parameters (2 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (3 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (2 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (7 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (2 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (3 ms)
    ✓ @HeaderParam should fail with missing required params (3 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @CookieParam should give a proper values from request headers (3 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (3 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (16 ms)
    ✓ @Body should fail if required body was not provided (6 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (5 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (18 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (3 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (12 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (4 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFile when required is used files must be provided (7 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (4 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (19 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (13 ms)
      ✓ should fail (17 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (59 ms)
      ✓ with roles (14 ms)
      ✓ async (22 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (18 ms)
      ✓ with roles (3 ms)
      ✓ async (14 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (20 ms)
      ✓ with roles (4 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (4 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (3 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (26 ms)
      ✓ should return custom code when @OnNull (30 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (7 ms)
      ✓ should return custom code when @OnUndefined (15 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return response with custom headers when @Header is used (3 ms)
      ✓ should relocate to new location when @Location is used (3 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (65 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (5 ms)
      should pass the valid param after validation
        ✓ succeed (4 ms)
        ✓ should contain param name on validation failed (15 ms)
    local options
      ✓ should apply local options (6 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (44 ms)
    should apply global options
      ✓ technical wrapper (4 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (46 ms)
      ✓ should call global error handler middleware (57 ms)
      ✓ should call global error handler middleware (26 ms)
      ✓ should call error handler middleware if used (5 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (57 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (16 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (48 ms)
      ✓ get should respond with proper status code, headers and body content (5 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (5 ms)
      ✓ wrong route should respond with 404 error (22 ms)
      ✓ wrong route should respond with 404 error (2 ms)
      ✓ wrong route should respond with 404 error (3 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (76 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (4 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (3 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (6 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (130 ms)
    using custom container should be possible
      ✓ custom container (12 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (16 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (26 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (29 ms)
      ✓ when controller transform is enabled (5 ms)
      ✓ when controller transform is disabled (3 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (19 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (3 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (2 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (2 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (3 ms)
      ✓ should handle errors in custom middlewares (22 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (26 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (21 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (2 ms)
      ✓ should return 400 from required paramOptions (16 ms)
      ✓ should return nullResultCode from defaults config (3 ms)
      ✓ should return status code from OnUndefined annotation (2 ms)
      ✓ should mark arg optional from QueryParam annotation (4 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (28 ms)
      ✓ using override (3 ms)
      ✓ using original (4 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (16 ms)
    ✓ should build meta if the only derivative controller is given (2 ms)
    ✓ should build meta if the only autonomous controller is given (1 ms)
    ✓ should build meta both when autonomous and derivative controllers are given (1 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (22 ms)
      ✓ should call global error handler middleware (19 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (30 ms)
    ✓ should override controller options with action transformRequest option (4 ms)
    ✓ should override controller options with action transformResponse option (3 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (21 ms)
      ✓ should send raw binary data from Buffer (2 ms)
      ✓ should send raw binary data from UIntArray (2 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (35 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (38 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (3 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (1 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        13.004 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (31 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty (1 ms)
      ✓ handle - should process number parameters
      ✓ handle - undefined on empty object provided (1 ms)
      ✓ handle - null provided (13 ms)
    negative
      ✕ handle - throws error if the parameter is required (7 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (23 ms)
      ✓ post respond with proper status code, headers and body content (8 ms)
      ✓ put respond with proper status code, headers and body content (5 ms)
      ✓ patch respond with proper status code, headers and body content (6 ms)
      ✓ delete respond with proper status code, headers and body content (5 ms)
      ✓ head respond with proper status code, headers and body content (5 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (5 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (4 ms)
      ✓ route should work with parameter (5 ms)
      ✓ route should work with regexp parameter (11 ms)
      ✓ should respond with 404 when regexp does not match (8 ms)
      ✓ route should work with string regexp parameter (4 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ should return result from a promise (506 ms)
      ✓ should respond with 500 if promise failed (504 ms)
      ✓ should respond with 204 No Content when null returned in action (15 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (20 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (2 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (5 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (2 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (10 ms)
      ✓ post respond with proper status code, headers and body content (3 ms)
      ✓ put respond with proper status code, headers and body content (2 ms)
      ✓ patch respond with proper status code, headers and body content (2 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (10 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (6 ms)
      ✓ route should work with string regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (504 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (9 ms)
      ✓ custom interceptor class should replace returned content (3 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (3 ms)
      ✓ global interceptor class should replace returned content (2 ms)
      ✓ interceptors should support promises (1005 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (10 ms)
    ✓ @Res writing directly to the response should work (4 ms)
    ✓ @Param should give a param from route (3 ms)
    ✓ @Param multiple params should give a proper values from route (2 ms)
    ✓ @SessionParam without middleware (26 ms)
    ✓ @Session should return a value from session (12 ms)
    ✓ @Session(param) should allow to inject empty property (4 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (14 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (6 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (16 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (7 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (4 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (4 ms)
    ✓ @QueryParam should give a proper values from request query parameters (3 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (4 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (3 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (3 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (10 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (2 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (5 ms)
    ✓ @HeaderParam should fail with missing required params (2 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (3 ms)
    ✓ @CookieParam should give a proper values from request headers (2 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (3 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (20 ms)
    ✓ @Body should fail if required body was not provided (10 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (4 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (17 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (4 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (11 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (4 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFile when required is used files must be provided (7 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (4 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (9 ms)
      ✓ should call global error handler middleware (23 ms)
      ✓ should call global error handler middleware (3 ms)
      ✓ should call error handler middleware if used (3 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (2 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (3 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (64 ms)
    using custom container should be possible
      ✓ custom container (6 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (9 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (11 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (80 ms)
      ✓ with roles (14 ms)
      ✓ async (24 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (4 ms)
      ✓ with roles (4 ms)
      ✓ async (13 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (19 ms)
      ✓ with roles (4 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (4 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (4 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (18 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (27 ms)
      ✓ should fail (24 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (25 ms)
      ✓ should return custom code when @OnNull (31 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (7 ms)
      ✓ should return custom code when @OnUndefined (9 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return response with custom headers when @Header is used (4 ms)
      ✓ should relocate to new location when @Location is used (3 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (65 ms)
      ✓ get should respond with proper status code, headers and body content (7 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (6 ms)
      ✓ wrong route should respond with 404 error (6 ms)
      ✓ wrong route should respond with 404 error (4 ms)
      ✓ wrong route should respond with 404 error (5 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (74 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (9 ms)
      should pass the valid param after validation
        ✓ succeed (7 ms)
        ✓ should contain param name on validation failed (56 ms)
    local options
      ✓ should apply local options (12 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (52 ms)
    should apply global options
      ✓ technical wrapper (4 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (10 ms)
    ✓ should build meta if the only derivative controller is given (2 ms)
    ✓ should build meta if the only autonomous controller is given (1 ms)
    ✓ should build meta both when autonomous and derivative controllers are given

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (30 ms)
      ✓ when controller transform is enabled (5 ms)
      ✓ when controller transform is disabled (3 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (20 ms)
      ✓ should call global error handler middleware (18 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (82 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (4 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (4 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (6 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (21 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (3 ms)
      ✓ should return 400 from required paramOptions (22 ms)
      ✓ should return nullResultCode from defaults config (4 ms)
      ✓ should return status code from OnUndefined annotation (3 ms)
      ✓ should mark arg optional from QueryParam annotation (4 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (23 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (3 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (2 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (2 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (3 ms)
      ✓ should handle errors in custom middlewares (20 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (36 ms)
    ✓ should override controller options with action transformRequest option (5 ms)
    ✓ should override controller options with action transformResponse option (3 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (39 ms)
      ✓ should render a template with given variables and locals variables (7 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (21 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (2 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (33 ms)
      ✓ using override (5 ms)
      ✓ using original (3 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (36 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (21 ms)
      ✓ should send raw binary data from Buffer (3 ms)
      ✓ should send raw binary data from UIntArray (3 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (2 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.896 s, estimated 13 s
Ran all test suites.
