11
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (28 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty (1 ms)
      ✓ handle - should process number parameters
      ✓ handle - undefined on empty object provided (1 ms)
      ✓ handle - null provided (13 ms)
    negative
      ✕ handle - throws error if the parameter is required (7 ms)
      ✓ handle - throws error if the parameter is required, type file provided (6 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (19 ms)
      ✓ post respond with proper status code, headers and body content (5 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (3 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (504 ms)
      ✓ should respond with 204 No Content when null returned in action (5 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (20 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (11 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (4 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (3 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (25 ms)
      ✓ post respond with proper status code, headers and body content (3 ms)
      ✓ put respond with proper status code, headers and body content (2 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (2 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (6 ms)
      ✓ route should work with string regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (505 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (20 ms)
      ✓ custom interceptor class should replace returned content (3 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (2 ms)
      ✓ global interceptor class should replace returned content (3 ms)
      ✓ interceptors should support promises (1003 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (10 ms)
    ✓ @Res writing directly to the response should work (4 ms)
    ✓ @Param should give a param from route (3 ms)
    ✓ @Param multiple params should give a proper values from route (2 ms)
    ✓ @SessionParam without middleware (22 ms)
    ✓ @Session should return a value from session (10 ms)
    ✓ @Session(param) should allow to inject empty property (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (5 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (13 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (2 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (3 ms)
    ✓ @QueryParam should give a proper values from request query parameters (2 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (3 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (2 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (7 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (2 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (5 ms)
    ✓ @HeaderParam should fail with missing required params (2 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @CookieParam should give a proper values from request headers (2 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (4 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (12 ms)
    ✓ @Body should fail if required body was not provided (6 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (8 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (17 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (4 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (11 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (5 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (4 ms)
    ✓ @UploadedFile when required is used files must be provided (6 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (5 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (18 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (13 ms)
      ✓ should fail (16 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (71 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (3 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (3 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (6 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (61 ms)
      ✓ with roles (16 ms)
      ✓ async (26 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (6 ms)
      ✓ with roles (3 ms)
      ✓ async (13 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (19 ms)
      ✓ with roles (4 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (4 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (16 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (60 ms)
    using custom container should be possible
      ✓ custom container (5 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (7 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (8 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (20 ms)
      ✓ should send raw binary data from Buffer (3 ms)
      ✓ should send raw binary data from UIntArray (2 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (58 ms)
      ✓ should return custom code when @OnNull (167 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (21 ms)
      ✓ should return custom code when @OnUndefined (21 ms)
      ✓ should return content-type in the response when @ContentType is used (3 ms)
      ✓ should return content-type in the response when @ContentType is used (3 ms)
      ✓ should return response with custom headers when @Header is used (3 ms)
      ✓ should relocate to new location when @Location is used (3 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (63 ms)
    ✓ should override controller options with action transformRequest option (4 ms)
    ✓ should override controller options with action transformResponse option (3 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (8 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (3 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (2 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (2 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (3 ms)
      ✓ should handle errors in custom middlewares (21 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (101 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (7 ms)
      should pass the valid param after validation
        ✓ succeed (6 ms)
        ✓ should contain param name on validation failed (16 ms)
    local options
      ✓ should apply local options (4 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (10 ms)
      ✓ should call global error handler middleware (23 ms)
      ✓ should call global error handler middleware (3 ms)
      ✓ should call error handler middleware if used (3 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (2 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (3 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (22 ms)
      ✓ should call global error handler middleware (17 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (25 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (10 ms)
    ✓ should build meta if the only derivative controller is given (2 ms)
    ✓ should build meta if the only autonomous controller is given (1 ms)
    ✓ should build meta both when autonomous and derivative controllers are given (1 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (29 ms)
      ✓ using override (4 ms)
      ✓ using original (3 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (34 ms)
      ✓ when controller transform is enabled (5 ms)
      ✓ when controller transform is disabled (5 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (23 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (2 ms)
      ✓ should return 400 from required paramOptions (16 ms)
      ✓ should return nullResultCode from defaults config (3 ms)
      ✓ should return status code from OnUndefined annotation (2 ms)
      ✓ should mark arg optional from QueryParam annotation (4 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (26 ms)
    should apply global options
      ✓ technical wrapper (4 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (23 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (3 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (54 ms)
      ✓ get should respond with proper status code, headers and body content (3 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (4 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (2 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (35 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (1 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.807 s, estimated 13 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (27 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty
      ✓ handle - should process number parameters (1 ms)
      ✓ handle - undefined on empty object provided
      ✓ handle - null provided (13 ms)
    negative
      ✕ handle - throws error if the parameter is required (7 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (19 ms)
      ✓ post respond with proper status code, headers and body content (5 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (5 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (504 ms)
      ✓ should respond with 204 No Content when null returned in action (5 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (30 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (3 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (4 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (2 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (25 ms)
      ✓ post respond with proper status code, headers and body content (3 ms)
      ✓ put respond with proper status code, headers and body content (2 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (2 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (1 ms)
      ✓ should return result from a promise (504 ms)
      ✓ should respond with 500 if promise failed (505 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (20 ms)
      ✓ custom interceptor class should replace returned content (3 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (2 ms)
      ✓ global interceptor class should replace returned content (2 ms)
      ✓ interceptors should support promises (1004 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (10 ms)
    ✓ @Res writing directly to the response should work (4 ms)
    ✓ @Param should give a param from route (3 ms)
    ✓ @Param multiple params should give a proper values from route (2 ms)
    ✓ @SessionParam without middleware (23 ms)
    ✓ @Session should return a value from session (9 ms)
    ✓ @Session(param) should allow to inject empty property (2 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (5 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (12 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (4 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (2 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (3 ms)
    ✓ @QueryParam should give a proper values from request query parameters (2 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (3 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (2 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (7 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (2 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (3 ms)
    ✓ @HeaderParam should fail with missing required params (3 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @CookieParam should give a proper values from request headers (2 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (3 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (12 ms)
    ✓ @Body should fail if required body was not provided (9 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (5 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (17 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (4 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (11 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (4 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFile when required is used files must be provided (6 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (5 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (10 ms)
      ✓ should return custom code when @OnNull (30 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (7 ms)
      ✓ should return custom code when @OnUndefined (10 ms)
      ✓ should return content-type in the response when @ContentType is used (3 ms)
      ✓ should return content-type in the response when @ContentType is used (3 ms)
      ✓ should return response with custom headers when @Header is used (7 ms)
      ✓ should relocate to new location when @Location is used (3 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (11 ms)
    ✓ should build meta if the only derivative controller is given (2 ms)
    ✓ should build meta if the only autonomous controller is given
    ✓ should build meta both when autonomous and derivative controllers are given (1 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (93 ms)
      ✓ with roles (14 ms)
      ✓ async (24 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (4 ms)
      ✓ with roles (3 ms)
      ✓ async (14 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (19 ms)
      ✓ with roles (4 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (4 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (3 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (71 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (5 ms)
      should pass the valid param after validation
        ✓ succeed (4 ms)
        ✓ should contain param name on validation failed (16 ms)
    local options
      ✓ should apply local options (5 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (20 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (13 ms)
      ✓ should fail (18 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (140 ms)
    ✓ should override controller options with action transformRequest option (51 ms)
    ✓ should override controller options with action transformResponse option (4 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (7 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (2 ms)
      ✓ should return 400 from required paramOptions (17 ms)
      ✓ should return nullResultCode from defaults config (19 ms)
      ✓ should return status code from OnUndefined annotation (2 ms)
      ✓ should mark arg optional from QueryParam annotation (6 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (56 ms)
    using custom container should be possible
      ✓ custom container (7 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (7 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (8 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (19 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (3 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (2 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (2 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (3 ms)
      ✓ should handle errors in custom middlewares (18 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (29 ms)
      ✓ when controller transform is enabled (5 ms)
      ✓ when controller transform is disabled (3 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (72 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (3 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (4 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (6 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (22 ms)
      ✓ should call global error handler middleware (15 ms)
      ✓ should call global error handler middleware (5 ms)
      ✓ should call error handler middleware if used (3 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (2 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (2 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (27 ms)
      ✓ using override (3 ms)
      ✓ using original (4 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (25 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (27 ms)
    should apply global options
      ✓ technical wrapper (4 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (71 ms)
      ✓ get should respond with proper status code, headers and body content (6 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (5 ms)
      ✓ wrong route should respond with 404 error (5 ms)
      ✓ wrong route should respond with 404 error (4 ms)
      ✓ wrong route should respond with 404 error (5 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (22 ms)
      ✓ should call global error handler middleware (17 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (22 ms)
      ✓ should send raw binary data from Buffer (2 ms)
      ✓ should send raw binary data from UIntArray (2 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (36 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (8 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (2 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (1 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.55 s, estimated 13 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (28 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty (1 ms)
      ✓ handle - should process number parameters
      ✓ handle - undefined on empty object provided
      ✓ handle - null provided (14 ms)
    negative
      ✕ handle - throws error if the parameter is required (7 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (19 ms)
      ✓ post respond with proper status code, headers and body content (5 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (3 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (505 ms)
      ✓ should respond with 204 No Content when null returned in action (5 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (32 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (3 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (4 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (2 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (25 ms)
      ✓ post respond with proper status code, headers and body content (2 ms)
      ✓ put respond with proper status code, headers and body content (2 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (2 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (3 ms)
      ✓ route should work with string regexp parameter (4 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (504 ms)
      ✓ should respond with 500 if promise failed (505 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (20 ms)
      ✓ custom interceptor class should replace returned content (3 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (2 ms)
      ✓ global interceptor class should replace returned content (3 ms)
      ✓ interceptors should support promises (1003 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (10 ms)
    ✓ @Res writing directly to the response should work (4 ms)
    ✓ @Param should give a param from route (3 ms)
    ✓ @Param multiple params should give a proper values from route (2 ms)
    ✓ @SessionParam without middleware (22 ms)
    ✓ @Session should return a value from session (10 ms)
    ✓ @Session(param) should allow to inject empty property (2 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (6 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (13 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (3 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (2 ms)
    ✓ @QueryParam should give a proper values from request query parameters (3 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (3 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (2 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (7 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (1 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (3 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (1 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (3 ms)
    ✓ @HeaderParam should fail with invalid request options (3 ms)
    ✓ @HeaderParam should fail with missing required params (2 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (3 ms)
    ✓ @CookieParam should give a proper values from request headers (2 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (4 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (1 ms)
    ✓ @Body should provide a request body (12 ms)
    ✓ @Body should fail if required body was not provided (6 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (5 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (21 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (4 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (11 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (4 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFile when required is used files must be provided (6 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (5 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (68 ms)
    ✓ should override controller options with action transformRequest option (5 ms)
    ✓ should override controller options with action transformResponse option (3 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (52 ms)
      ✓ with roles (14 ms)
      ✓ async (24 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (3 ms)
      ✓ with roles (4 ms)
      ✓ async (13 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (19 ms)
      ✓ with roles (15 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (5 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (4 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (22 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (2 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (3 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (2 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (3 ms)
      ✓ should handle errors in custom middlewares (21 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (30 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (7 ms)
      ✓ should fail (16 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (11 ms)
      ✓ should return custom code when @OnNull (30 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (6 ms)
      ✓ should return custom code when @OnUndefined (9 ms)
      ✓ should return content-type in the response when @ContentType is used (1 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return response with custom headers when @Header is used (6 ms)
      ✓ should relocate to new location when @Location is used (1 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (12 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (4 ms)
      ✓ should return 400 from required paramOptions (21 ms)
      ✓ should return nullResultCode from defaults config (4 ms)
      ✓ should return status code from OnUndefined annotation (4 ms)
      ✓ should mark arg optional from QueryParam annotation (5 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (53 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (7 ms)
      should pass the valid param after validation
        ✓ succeed (4 ms)
        ✓ should contain param name on validation failed (15 ms)
    local options
      ✓ should apply local options (5 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (62 ms)
    using custom container should be possible
      ✓ custom container (5 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (8 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (7 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (51 ms)
      ✓ get should respond with proper status code, headers and body content (3 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (4 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (4 ms)
      ✓ wrong route should respond with 404 error (3 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (71 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (4 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (3 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (6 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (11 ms)
    ✓ should build meta if the only derivative controller is given (1 ms)
    ✓ should build meta if the only autonomous controller is given (1 ms)
    ✓ should build meta both when autonomous and derivative controllers are given (1 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (9 ms)
      ✓ should call global error handler middleware (20 ms)
      ✓ should call global error handler middleware (4 ms)
      ✓ should call error handler middleware if used (3 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (2 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (3 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (14 ms)
    should apply global options
      ✓ technical wrapper (4 ms)
    should apply local options
      ✓ technical wrapper (5 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (18 ms)
      ✓ when controller transform is enabled (4 ms)
      ✓ when controller transform is disabled (3 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (36 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (25 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (29 ms)
      ✓ using override (4 ms)
      ✓ using original (3 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (9 ms)
      ✓ should call global error handler middleware (16 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (8 ms)
      ✓ should send raw binary data from Buffer (2 ms)
      ✓ should send raw binary data from UIntArray (2 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (8 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (2 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (1 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.55 s, estimated 13 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (32 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty
      ✓ handle - should process number parameters (1 ms)
      ✓ handle - undefined on empty object provided
      ✓ handle - null provided (13 ms)
    negative
      ✕ handle - throws error if the parameter is required (7 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (20 ms)
      ✓ post respond with proper status code, headers and body content (4 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (513 ms)
      ✓ should respond with 204 No Content when null returned in action (5 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (21 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (2 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (4 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (2 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (10 ms)
      ✓ post respond with proper status code, headers and body content (3 ms)
      ✓ put respond with proper status code, headers and body content (2 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (2 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (1 ms)
      ✓ should return result from a promise (504 ms)
      ✓ should respond with 500 if promise failed (504 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (8 ms)
      ✓ custom interceptor class should replace returned content (3 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (2 ms)
      ✓ global interceptor class should replace returned content (3 ms)
      ✓ interceptors should support promises (1003 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (10 ms)
    ✓ @Res writing directly to the response should work (4 ms)
    ✓ @Param should give a param from route (3 ms)
    ✓ @Param multiple params should give a proper values from route (2 ms)
    ✓ @SessionParam without middleware (23 ms)
    ✓ @Session should return a value from session (9 ms)
    ✓ @Session(param) should allow to inject empty property (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (15 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (5 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (2 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (2 ms)
    ✓ @QueryParam should give a proper values from request query parameters (3 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (2 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (8 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (2 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (5 ms)
    ✓ @HeaderParam should fail with missing required params (2 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @CookieParam should give a proper values from request headers (2 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (4 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (12 ms)
    ✓ @Body should fail if required body was not provided (9 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (4 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (17 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (4 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (11 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (5 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (4 ms)
    ✓ @UploadedFile when required is used files must be provided (7 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (4 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (64 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (8 ms)
      should pass the valid param after validation
        ✓ succeed (6 ms)
        ✓ should contain param name on validation failed (16 ms)
    local options
      ✓ should apply local options (6 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (24 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (13 ms)
      ✓ should fail (17 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (52 ms)
      ✓ with roles (14 ms)
      ✓ async (23 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (3 ms)
      ✓ with roles (4 ms)
      ✓ async (13 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (19 ms)
      ✓ with roles (15 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (4 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (4 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (83 ms)
      ✓ get should respond with proper status code, headers and body content (4 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (3 ms)
      ✓ wrong route should respond with 404 error (4 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (2 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (25 ms)
      ✓ should return custom code when @OnNull (30 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (6 ms)
      ✓ should return custom code when @OnUndefined (9 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return response with custom headers when @Header is used (4 ms)
      ✓ should relocate to new location when @Location is used (2 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (185 ms)
    ✓ should override controller options with action transformRequest option (5 ms)
    ✓ should override controller options with action transformResponse option (3 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (83 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (4 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (4 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (6 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (19 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (2 ms)
      ✓ should return 400 from required paramOptions (16 ms)
      ✓ should return nullResultCode from defaults config (3 ms)
      ✓ should return status code from OnUndefined annotation (2 ms)
      ✓ should mark arg optional from QueryParam annotation (4 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (53 ms)
    using custom container should be possible
      ✓ custom container (6 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (7 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (8 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (23 ms)
      ✓ using override (5 ms)
      ✓ using original (4 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (18 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (2 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (3 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (2 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (2 ms)
      ✓ should handle errors in custom middlewares (22 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (32 ms)
      ✓ when controller transform is enabled (4 ms)
      ✓ when controller transform is disabled (4 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (21 ms)
      ✓ should call global error handler middleware (21 ms)
      ✓ should call global error handler middleware (3 ms)
      ✓ should call error handler middleware if used (2 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (2 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (2 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (10 ms)
    ✓ should build meta if the only derivative controller is given (2 ms)
    ✓ should build meta if the only autonomous controller is given (1 ms)
    ✓ should build meta both when autonomous and derivative controllers are given

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (13 ms)
    should apply global options
      ✓ technical wrapper (4 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (13 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (35 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (22 ms)
      ✓ should send raw binary data from Buffer (2 ms)
      ✓ should send raw binary data from UIntArray (2 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (8 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (16 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (9 ms)
      ✓ should call global error handler middleware (33 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (1 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.53 s, estimated 13 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (28 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty
      ✓ handle - should process number parameters
      ✓ handle - undefined on empty object provided
      ✓ handle - null provided (14 ms)
    negative
      ✕ handle - throws error if the parameter is required (7 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (19 ms)
      ✓ post respond with proper status code, headers and body content (4 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (3 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (504 ms)
      ✓ should respond with 500 if promise failed (504 ms)
      ✓ should respond with 204 No Content when null returned in action (5 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (21 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (2 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (11 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (4 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (2 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (26 ms)
      ✓ post respond with proper status code, headers and body content (2 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (2 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (504 ms)
      ✓ should respond with 500 if promise failed (505 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (20 ms)
      ✓ custom interceptor class should replace returned content (3 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (2 ms)
      ✓ global interceptor class should replace returned content (2 ms)
      ✓ interceptors should support promises (1003 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (11 ms)
    ✓ @Res writing directly to the response should work (4 ms)
    ✓ @Param should give a param from route (4 ms)
    ✓ @Param multiple params should give a proper values from route (3 ms)
    ✓ @SessionParam without middleware (23 ms)
    ✓ @Session should return a value from session (11 ms)
    ✓ @Session(param) should allow to inject empty property (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (6 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (4 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (11 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (2 ms)
    ✓ @QueryParam should give a proper values from request query parameters (2 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (2 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (8 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (1 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (3 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (2 ms)
    ✓ @HeaderParam should fail with missing required params (3 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (3 ms)
    ✓ @CookieParam should give a proper values from request headers (3 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (3 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (12 ms)
    ✓ @Body should fail if required body was not provided (6 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (4 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (20 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (3 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (12 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (4 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFile when required is used files must be provided (6 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (5 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (69 ms)
    ✓ should override controller options with action transformRequest option (4 ms)
    ✓ should override controller options with action transformResponse option (3 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (52 ms)
      ✓ with roles (13 ms)
      ✓ async (23 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (4 ms)
      ✓ with roles (3 ms)
      ✓ async (13 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (20 ms)
      ✓ with roles (3 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (16 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (5 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (32 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (8 ms)
      ✓ should fail (16 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (21 ms)
      ✓ should send raw binary data from Buffer (3 ms)
      ✓ should send raw binary data from UIntArray (2 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (24 ms)
      ✓ should return custom code when @OnNull (30 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (7 ms)
      ✓ should return custom code when @OnUndefined (8 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return response with custom headers when @Header is used (4 ms)
      ✓ should relocate to new location when @Location is used (2 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (98 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (23 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (7 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (26 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (52 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (5 ms)
      should pass the valid param after validation
        ✓ succeed (5 ms)
        ✓ should contain param name on validation failed (17 ms)
    local options
      ✓ should apply local options (5 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (55 ms)
      ✓ get should respond with proper status code, headers and body content (4 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (3 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (2 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (19 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (2 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (2 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (3 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (2 ms)
      ✓ should handle errors in custom middlewares (22 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (10 ms)
    ✓ should build meta if the only derivative controller is given (2 ms)
    ✓ should build meta if the only autonomous controller is given (1 ms)
    ✓ should build meta both when autonomous and derivative controllers are given

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (12 ms)
      ✓ should call global error handler middleware (19 ms)
      ✓ should call global error handler middleware (18 ms)
      ✓ should call error handler middleware if used (4 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (7 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (3 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (55 ms)
    using custom container should be possible
      ✓ custom container (7 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (7 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (7 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (7 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (2 ms)
      ✓ should return 400 from required paramOptions (13 ms)
      ✓ should return nullResultCode from defaults config (3 ms)
      ✓ should return status code from OnUndefined annotation (2 ms)
      ✓ should mark arg optional from QueryParam annotation (4 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (32 ms)
      ✓ when controller transform is enabled (5 ms)
      ✓ when controller transform is disabled (4 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (30 ms)
    should apply global options
      ✓ technical wrapper (4 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (25 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (19 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (2 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (21 ms)
      ✓ should call global error handler middleware (17 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (36 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (16 ms)
      ✓ using override (17 ms)
      ✓ using original (4 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (2 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.554 s, estimated 13 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (28 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty
      ✓ handle - should process number parameters (1 ms)
      ✓ handle - undefined on empty object provided
      ✓ handle - null provided (16 ms)
    negative
      ✕ handle - throws error if the parameter is required (7 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (19 ms)
      ✓ post respond with proper status code, headers and body content (5 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (5 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (504 ms)
      ✓ should respond with 204 No Content when null returned in action (5 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (20 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (2 ms)
      ✓ should respond with 200 and text/html even in json controller's method (11 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (4 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (2 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (27 ms)
      ✓ post respond with proper status code, headers and body content (2 ms)
      ✓ put respond with proper status code, headers and body content (2 ms)
      ✓ patch respond with proper status code, headers and body content (2 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (7 ms)
      ✓ route should work with string regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (503 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (20 ms)
      ✓ custom interceptor class should replace returned content (3 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (2 ms)
      ✓ global interceptor class should replace returned content (2 ms)
      ✓ interceptors should support promises (1004 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (19 ms)
    ✓ @Res writing directly to the response should work (7 ms)
    ✓ @Param should give a param from route (6 ms)
    ✓ @Param multiple params should give a proper values from route (5 ms)
    ✓ @SessionParam without middleware (38 ms)
    ✓ @Session should return a value from session (19 ms)
    ✓ @Session(param) should allow to inject empty property (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (6 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (13 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (3 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (2 ms)
    ✓ @QueryParam should give a proper values from request query parameters (3 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (3 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (2 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (8 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (2 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (4 ms)
    ✓ @HeaderParam should fail with missing required params (3 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (1 ms)
    ✓ @CookieParam should give a proper values from request headers (3 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (3 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (12 ms)
    ✓ @Body should fail if required body was not provided (6 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (6 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (5 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (20 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (5 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (12 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (4 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFile when required is used files must be provided (6 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (5 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (65 ms)
      ✓ with roles (14 ms)
      ✓ async (23 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (4 ms)
      ✓ with roles (3 ms)
      ✓ async (14 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (22 ms)
      ✓ with roles (3 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (5 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (3 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (53 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (7 ms)
      should pass the valid param after validation
        ✓ succeed (6 ms)
        ✓ should contain param name on validation failed (15 ms)
    local options
      ✓ should apply local options (4 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (71 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (4 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (3 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (6 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (12 ms)
      ✓ should return custom code when @OnNull (29 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (6 ms)
      ✓ should return custom code when @OnUndefined (9 ms)
      ✓ should return content-type in the response when @ContentType is used (14 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return response with custom headers when @Header is used (3 ms)
      ✓ should relocate to new location when @Location is used (3 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (27 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (54 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (40 ms)
      ✓ should fail (47 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (60 ms)
    ✓ should override controller options with action transformRequest option (4 ms)
    ✓ should override controller options with action transformResponse option (16 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (12 ms)
      ✓ should call global error handler middleware (20 ms)
      ✓ should call global error handler middleware (17 ms)
      ✓ should call error handler middleware if used (4 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (2 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (3 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (53 ms)
    using custom container should be possible
      ✓ custom container (5 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (8 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (7 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (19 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (3 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (2 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (3 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (4 ms)
      ✓ should handle errors in custom middlewares (22 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (27 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (3 ms)
      ✓ should return 400 from required paramOptions (21 ms)
      ✓ should return nullResultCode from defaults config (3 ms)
      ✓ should return status code from OnUndefined annotation (2 ms)
      ✓ should mark arg optional from QueryParam annotation (4 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (32 ms)
      ✓ when controller transform is enabled (4 ms)
      ✓ when controller transform is disabled (4 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (11 ms)
    ✓ should build meta if the only derivative controller is given (1 ms)
    ✓ should build meta if the only autonomous controller is given
    ✓ should build meta both when autonomous and derivative controllers are given (1 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (17 ms)
    should apply global options
      ✓ technical wrapper (5 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (21 ms)
      ✓ should send raw binary data from Buffer (3 ms)
      ✓ should send raw binary data from UIntArray (2 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (25 ms)
      ✓ should render a template with given variables and locals variables (5 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (53 ms)
      ✓ get should respond with proper status code, headers and body content (4 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (3 ms)
      ✓ wrong route should respond with 404 error (4 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (2 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (26 ms)
      ✓ using override (3 ms)
      ✓ using original (4 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (8 ms)
      ✓ should call global error handler middleware (32 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (8 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (16 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (2 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.766 s, estimated 13 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (27 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty (1 ms)
      ✓ handle - should process number parameters
      ✓ handle - undefined on empty object provided
      ✓ handle - null provided (13 ms)
    negative
      ✕ handle - throws error if the parameter is required (7 ms)
      ✓ handle - throws error if the parameter is required, type file provided (5 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (19 ms)
      ✓ post respond with proper status code, headers and body content (5 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (5 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (504 ms)
      ✓ should respond with 500 if promise failed (504 ms)
      ✓ should respond with 204 No Content when null returned in action (5 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (21 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (2 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (10 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (4 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (3 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (24 ms)
      ✓ post respond with proper status code, headers and body content (3 ms)
      ✓ put respond with proper status code, headers and body content (2 ms)
      ✓ patch respond with proper status code, headers and body content (2 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (7 ms)
      ✓ route should work with string regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (504 ms)
      ✓ should respond with 500 if promise failed (504 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (21 ms)
      ✓ custom interceptor class should replace returned content (2 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (3 ms)
      ✓ global interceptor class should replace returned content (2 ms)
      ✓ interceptors should support promises (1004 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (11 ms)
    ✓ @Res writing directly to the response should work (4 ms)
    ✓ @Param should give a param from route (3 ms)
    ✓ @Param multiple params should give a proper values from route (3 ms)
    ✓ @SessionParam without middleware (22 ms)
    ✓ @Session should return a value from session (11 ms)
    ✓ @Session(param) should allow to inject empty property (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (6 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (14 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (3 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (3 ms)
    ✓ @QueryParam should give a proper values from request query parameters (2 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (3 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (2 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (7 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (3 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (3 ms)
    ✓ @HeaderParam should fail with missing required params (3 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (3 ms)
    ✓ @CookieParam should give a proper values from request headers (2 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (4 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (12 ms)
    ✓ @Body should fail if required body was not provided (7 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (8 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (17 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (4 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (12 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (4 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFile when required is used files must be provided (7 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (5 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (71 ms)
      ✓ with roles (14 ms)
      ✓ async (25 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (4 ms)
      ✓ with roles (4 ms)
      ✓ async (13 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (21 ms)
      ✓ with roles (4 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (5 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (4 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (21 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (15 ms)
      ✓ should fail (30 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (64 ms)
    ✓ should override controller options with action transformRequest option (4 ms)
    ✓ should override controller options with action transformResponse option (3 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (11 ms)
      ✓ should return custom code when @OnNull (29 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (6 ms)
      ✓ should return custom code when @OnUndefined (8 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return response with custom headers when @Header is used (3 ms)
      ✓ should relocate to new location when @Location is used (3 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (7 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (3 ms)
      ✓ should return 400 from required paramOptions (16 ms)
      ✓ should return nullResultCode from defaults config (3 ms)
      ✓ should return status code from OnUndefined annotation (2 ms)
      ✓ should mark arg optional from QueryParam annotation (4 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (30 ms)
      ✓ should call global error handler middleware (54 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (9 ms)
      ✓ should call global error handler middleware (21 ms)
      ✓ should call global error handler middleware (5 ms)
      ✓ should call error handler middleware if used (4 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (3 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (16 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (44 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (6 ms)
      should pass the valid param after validation
        ✓ succeed (4 ms)
        ✓ should contain param name on validation failed (16 ms)
    local options
      ✓ should apply local options (20 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (25 ms)
    ✓ should build meta if the only derivative controller is given (2 ms)
    ✓ should build meta if the only autonomous controller is given
    ✓ should build meta both when autonomous and derivative controllers are given (1 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (58 ms)
    using custom container should be possible
      ✓ custom container (6 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (8 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (7 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (84 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (6 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (15 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (8 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (35 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (33 ms)
      ✓ when controller transform is enabled (5 ms)
      ✓ when controller transform is disabled (3 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (23 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (2 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (3 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (2 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (2 ms)
      ✓ should handle errors in custom middlewares (23 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (31 ms)
    should apply global options
      ✓ technical wrapper (4 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (53 ms)
      ✓ get should respond with proper status code, headers and body content (4 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (4 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (2 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (25 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (27 ms)
      ✓ using override (3 ms)
      ✓ using original (4 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (22 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (3 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (8 ms)
      ✓ should send raw binary data from Buffer (3 ms)
      ✓ should send raw binary data from UIntArray (2 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (2 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.638 s, estimated 13 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (27 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty (1 ms)
      ✓ handle - should process number parameters
      ✓ handle - undefined on empty object provided
      ✓ handle - null provided (13 ms)
    negative
      ✕ handle - throws error if the parameter is required (7 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (20 ms)
      ✓ post respond with proper status code, headers and body content (4 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (3 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (504 ms)
      ✓ should respond with 204 No Content when null returned in action (5 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (20 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (3 ms)
      ✓ should respond with 200 and text/html even in json controller's method (11 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (1 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (5 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (2 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (25 ms)
      ✓ post respond with proper status code, headers and body content (3 ms)
      ✓ put respond with proper status code, headers and body content (2 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (3 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (1 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (504 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (21 ms)
      ✓ custom interceptor class should replace returned content (3 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (2 ms)
      ✓ global interceptor class should replace returned content (2 ms)
      ✓ interceptors should support promises (1004 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (10 ms)
    ✓ @Res writing directly to the response should work (4 ms)
    ✓ @Param should give a param from route (3 ms)
    ✓ @Param multiple params should give a proper values from route (2 ms)
    ✓ @SessionParam without middleware (22 ms)
    ✓ @Session should return a value from session (10 ms)
    ✓ @Session(param) should allow to inject empty property (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (6 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (4 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (11 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (2 ms)
    ✓ @QueryParam should give a proper values from request query parameters (3 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (3 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (3 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (11 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (4 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (3 ms)
    ✓ @HeaderParam should give a proper values from request headers (3 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (3 ms)
    ✓ @HeaderParam should fail with invalid request options (3 ms)
    ✓ @HeaderParam should fail with missing required params (3 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (3 ms)
    ✓ @CookieParam should give a proper values from request headers (4 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (6 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (3 ms)
    ✓ @Body should provide a request body (17 ms)
    ✓ @Body should fail if required body was not provided (8 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (7 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (30 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (6 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (23 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (5 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (4 ms)
    ✓ @UploadedFile when required is used files must be provided (7 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (4 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (22 ms)
      ✓ should call global error handler middleware (22 ms)
      ✓ should call global error handler middleware (4 ms)
      ✓ should call error handler middleware if used (3 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (2 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (3 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (67 ms)
      ✓ with roles (14 ms)
      ✓ async (24 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (4 ms)
      ✓ with roles (3 ms)
      ✓ async (13 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (20 ms)
      ✓ with roles (5 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (9 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (4 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (11 ms)
      ✓ should return custom code when @OnNull (30 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (7 ms)
      ✓ should return custom code when @OnUndefined (8 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return content-type in the response when @ContentType is used (14 ms)
      ✓ should return response with custom headers when @Header is used (3 ms)
      ✓ should relocate to new location when @Location is used (3 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (33 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (13 ms)
      ✓ should fail (17 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (23 ms)
      ✓ should call global error handler middleware (18 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (31 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (12 ms)
      ✓ should return 400 from required paramOptions (36 ms)
      ✓ should return nullResultCode from defaults config (25 ms)
      ✓ should return status code from OnUndefined annotation (13 ms)
      ✓ should mark arg optional from QueryParam annotation (7 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (74 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (4 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (3 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (20 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (64 ms)
    ✓ should override controller options with action transformRequest option (5 ms)
    ✓ should override controller options with action transformResponse option (2 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (56 ms)
    using custom container should be possible
      ✓ custom container (6 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (7 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (7 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (19 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (4 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (60 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (5 ms)
      should pass the valid param after validation
        ✓ succeed (4 ms)
        ✓ should contain param name on validation failed (14 ms)
    local options
      ✓ should apply local options (6 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (22 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (3 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (2 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (2 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (2 ms)
      ✓ should handle errors in custom middlewares (20 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (10 ms)
    ✓ should build meta if the only derivative controller is given (2 ms)
    ✓ should build meta if the only autonomous controller is given
    ✓ should build meta both when autonomous and derivative controllers are given (1 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (18 ms)
      ✓ when controller transform is enabled (4 ms)
      ✓ when controller transform is disabled (4 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (17 ms)
    should apply global options
      ✓ technical wrapper (4 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (35 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (52 ms)
      ✓ get should respond with proper status code, headers and body content (4 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (3 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (2 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (26 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (27 ms)
      ✓ using override (4 ms)
      ✓ using original (3 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (8 ms)
      ✓ should send raw binary data from Buffer (16 ms)
      ✓ should send raw binary data from UIntArray (2 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (5 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (2 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.562 s, estimated 13 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (31 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty
      ✓ handle - should process number parameters
      ✓ handle - undefined on empty object provided
      ✓ handle - null provided (12 ms)
    negative
      ✕ handle - throws error if the parameter is required (7 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (19 ms)
      ✓ post respond with proper status code, headers and body content (5 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (5 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (504 ms)
      ✓ should respond with 204 No Content when null returned in action (5 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (30 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (3 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (4 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (3 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (10 ms)
      ✓ post respond with proper status code, headers and body content (2 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (2 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (5 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (1 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (504 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (22 ms)
      ✓ custom interceptor class should replace returned content (2 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (3 ms)
      ✓ global interceptor class should replace returned content (2 ms)
      ✓ interceptors should support promises (1004 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (10 ms)
    ✓ @Res writing directly to the response should work (3 ms)
    ✓ @Param should give a param from route (3 ms)
    ✓ @Param multiple params should give a proper values from route (3 ms)
    ✓ @SessionParam without middleware (21 ms)
    ✓ @Session should return a value from session (10 ms)
    ✓ @Session(param) should allow to inject empty property (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (6 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (11 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (4 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (3 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (2 ms)
    ✓ @QueryParam should give a proper values from request query parameters (3 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (2 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (8 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (1 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (2 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (2 ms)
    ✓ @HeaderParam should fail with missing required params (3 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (3 ms)
    ✓ @CookieParam should give a proper values from request headers (3 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (3 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (12 ms)
    ✓ @Body should fail if required body was not provided (6 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (7 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (4 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (17 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (4 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (11 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (4 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFile when required is used files must be provided (6 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (4 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (74 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (4 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (3 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (5 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (64 ms)
      ✓ with roles (14 ms)
      ✓ async (24 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (4 ms)
      ✓ with roles (4 ms)
      ✓ async (12 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (20 ms)
      ✓ with roles (4 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (7 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (4 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (7 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (2 ms)
      ✓ should return 400 from required paramOptions (15 ms)
      ✓ should return nullResultCode from defaults config (2 ms)
      ✓ should return status code from OnUndefined annotation (3 ms)
      ✓ should mark arg optional from QueryParam annotation (4 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (11 ms)
      ✓ should return custom code when @OnNull (29 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (6 ms)
      ✓ should return custom code when @OnUndefined (22 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return content-type in the response when @ContentType is used (9 ms)
      ✓ should return response with custom headers when @Header is used (3 ms)
      ✓ should relocate to new location when @Location is used (13 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (31 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (13 ms)
      ✓ should fail (20 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (11 ms)
    ✓ should build meta if the only derivative controller is given (1 ms)
    ✓ should build meta if the only autonomous controller is given (1 ms)
    ✓ should build meta both when autonomous and derivative controllers are given (1 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (77 ms)
    ✓ should override controller options with action transformRequest option (5 ms)
    ✓ should override controller options with action transformResponse option (4 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (53 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (5 ms)
      should pass the valid param after validation
        ✓ succeed (5 ms)
        ✓ should contain param name on validation failed (17 ms)
    local options
      ✓ should apply local options (5 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (55 ms)
    using custom container should be possible
      ✓ custom container (6 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (8 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (7 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (21 ms)
      ✓ should call global error handler middleware (19 ms)
      ✓ should call global error handler middleware (5 ms)
      ✓ should call error handler middleware if used (3 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (2 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (3 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (28 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (4 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (3 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (3 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (2 ms)
      ✓ should handle errors in custom middlewares (20 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (33 ms)
      ✓ when controller transform is enabled (4 ms)
      ✓ when controller transform is disabled (3 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (30 ms)
    should apply global options
      ✓ technical wrapper (5 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (22 ms)
      ✓ should call global error handler middleware (17 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (28 ms)
      ✓ using override (4 ms)
      ✓ using original (4 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (27 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (54 ms)
      ✓ get should respond with proper status code, headers and body content (4 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (4 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (2 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (36 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (22 ms)
      ✓ should send raw binary data from Buffer (2 ms)
      ✓ should send raw binary data from UIntArray (2 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (11 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (27 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (4 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (1 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.737 s, estimated 13 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (28 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty
      ✓ handle - should process number parameters (1 ms)
      ✓ handle - undefined on empty object provided
      ✓ handle - null provided (12 ms)
    negative
      ✕ handle - throws error if the parameter is required (7 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (19 ms)
      ✓ post respond with proper status code, headers and body content (5 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (3 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (7 ms)
      ✓ route should work with string regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (504 ms)
      ✓ should respond with 500 if promise failed (506 ms)
      ✓ should respond with 204 No Content when null returned in action (5 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (20 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (11 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (5 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (2 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (25 ms)
      ✓ post respond with proper status code, headers and body content (3 ms)
      ✓ put respond with proper status code, headers and body content (2 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (2 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (3 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (2 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (1 ms)
      ✓ should return result from a promise (505 ms)
      ✓ should respond with 500 if promise failed (503 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (21 ms)
      ✓ custom interceptor class should replace returned content (2 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (3 ms)
      ✓ global interceptor class should replace returned content (2 ms)
      ✓ interceptors should support promises (1004 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (10 ms)
    ✓ @Res writing directly to the response should work (4 ms)
    ✓ @Param should give a param from route (3 ms)
    ✓ @Param multiple params should give a proper values from route (2 ms)
    ✓ @SessionParam without middleware (22 ms)
    ✓ @Session should return a value from session (10 ms)
    ✓ @Session(param) should allow to inject empty property (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (5 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (3 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (13 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (2 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (3 ms)
    ✓ @QueryParam should give a proper values from request query parameters (2 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (3 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (1 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (3 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (7 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (2 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (2 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (3 ms)
    ✓ @HeaderParam should fail with missing required params (3 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @CookieParam should give a proper values from request headers (2 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (4 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (12 ms)
    ✓ @Body should fail if required body was not provided (6 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (9 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (16 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (4 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (11 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (5 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (4 ms)
    ✓ @UploadedFile when required is used files must be provided (6 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (5 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (69 ms)
    ✓ should override controller options with action transformRequest option (5 ms)
    ✓ should override controller options with action transformResponse option (3 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (9 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (2 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (2 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (2 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (2 ms)
      ✓ should handle errors in custom middlewares (22 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (51 ms)
      ✓ with roles (15 ms)
      ✓ async (24 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (4 ms)
      ✓ with roles (3 ms)
      ✓ async (13 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (19 ms)
      ✓ with roles (3 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (18 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (4 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (26 ms)
      ✓ should return custom code when @OnNull (48 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (8 ms)
      ✓ should return custom code when @OnUndefined (9 ms)
      ✓ should return content-type in the response when @ContentType is used (1 ms)
      ✓ should return content-type in the response when @ContentType is used (3 ms)
      ✓ should return response with custom headers when @Header is used (3 ms)
      ✓ should relocate to new location when @Location is used (2 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (26 ms)
    should apply global options
      ✓ technical wrapper (5 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (52 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (32 ms)
      ✓ should fail (98 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (77 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (19 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (4 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (7 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (56 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (5 ms)
      should pass the valid param after validation
        ✓ succeed (4 ms)
        ✓ should contain param name on validation failed (16 ms)
    local options
      ✓ should apply local options (5 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (10 ms)
    ✓ should build meta if the only derivative controller is given (2 ms)
    ✓ should build meta if the only autonomous controller is given (1 ms)
    ✓ should build meta both when autonomous and derivative controllers are given (1 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (57 ms)
    using custom container should be possible
      ✓ custom container (5 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (7 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (8 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (21 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (3 ms)
      ✓ should return 400 from required paramOptions (16 ms)
      ✓ should return nullResultCode from defaults config (3 ms)
      ✓ should return status code from OnUndefined annotation (2 ms)
      ✓ should mark arg optional from QueryParam annotation (4 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (34 ms)
      ✓ when controller transform is enabled (5 ms)
      ✓ when controller transform is disabled (4 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (23 ms)
      ✓ should call global error handler middleware (17 ms)
      ✓ should call global error handler middleware (6 ms)
      ✓ should call error handler middleware if used (2 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (3 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (2 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (25 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (21 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (3 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (53 ms)
      ✓ get should respond with proper status code, headers and body content (3 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (3 ms)
      ✓ wrong route should respond with 404 error (4 ms)
      ✓ wrong route should respond with 404 error (2 ms)
      ✓ wrong route should respond with 404 error (3 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (21 ms)
      ✓ should call global error handler middleware (19 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (27 ms)
      ✓ using override (4 ms)
      ✓ using original (3 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (8 ms)
      ✓ should send raw binary data from Buffer (2 ms)
      ✓ should send raw binary data from UIntArray (2 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (23 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (4 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (1 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.527 s, estimated 13 s
Ran all test suites.
ts-jest[config] (WARN) The option `tsConfig` is deprecated and will be removed in ts-jest 27, use `tsconfig` instead
FAIL test/ActionParameterHandler.spec.ts
  ActionParameterHandler
    positive
      ✓ handle - should process string parameters (27 ms)
      ✓ handle - should process string parameters, returns empty if a given string is empty (1 ms)
      ✓ handle - should process number parameters
      ✓ handle - undefined on empty object provided
      ✓ handle - null provided (16 ms)
    negative
      ✕ handle - throws error if the parameter is required (7 ms)
      ✓ handle - throws error if the parameter is required, type file provided (1 ms)

  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)

PASS test/functional/controller-methods.spec.ts
    controller methods
      ✓ get should respond with proper status code, headers and body content (19 ms)
      ✓ post respond with proper status code, headers and body content (5 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (3 ms)
      ✓ delete respond with proper status code, headers and body content (3 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (3 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (4 ms)
      ✓ route should work with string regexp parameter (3 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (503 ms)
      ✓ should respond with 500 if promise failed (505 ms)
      ✓ should respond with 204 No Content when null returned in action (5 ms)
      ✓ should respond with 404 Not Found text when undefined returned in action (31 ms)
      ✓ should respond with 404 Not Found JSON when undefined returned in action (2 ms)
      ✓ should respond with 200 and text/html even in json controller's method (2 ms)
      ✓ should respond with 200 and text/plain even in json controller's method (2 ms)
      ✓ should respond with 401 and text/html when UnauthorizedError throwed even in json controller's method (5 ms)
      ✓ should respond with 401 and aplication/json when UnauthorizedError is thrown in standard json controller's method (2 ms)

PASS test/functional/json-controller-methods.spec.ts
    json-controller methods
      ✓ get should respond with proper status code, headers and body content (10 ms)
      ✓ post respond with proper status code, headers and body content (2 ms)
      ✓ put respond with proper status code, headers and body content (3 ms)
      ✓ patch respond with proper status code, headers and body content (2 ms)
      ✓ delete respond with proper status code, headers and body content (2 ms)
      ✓ head respond with proper status code, headers and body content (3 ms)
      ✓ custom method (post) respond with proper status code, headers and body content (2 ms)
      ✓ custom method (delete) respond with proper status code, headers and body content (2 ms)
      ✓ route should work with parameter (3 ms)
      ✓ route should work with regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (7 ms)
      ✓ route should work with string regexp parameter (2 ms)
      ✓ should respond with 404 when regexp does not match (2 ms)
      ✓ should return result from a promise (504 ms)
      ✓ should respond with 500 if promise failed (504 ms)

PASS test/functional/interceptors.spec.ts
    interceptor
      ✓ custom interceptor function should replace returned content (21 ms)
      ✓ custom interceptor class should replace returned content (3 ms)
      ✓ custom interceptor class used on the whole controller should replace returned content (2 ms)
      ✓ global interceptor class should replace returned content (2 ms)
      ✓ interceptors should support promises (1004 ms)

PASS test/functional/action-params.spec.ts
    ✓ @Req and @Res should be provided as Request and Response objects (10 ms)
    ✓ @Res writing directly to the response should work (3 ms)
    ✓ @Param should give a param from route (4 ms)
    ✓ @Param multiple params should give a proper values from route (2 ms)
    ✓ @SessionParam without middleware (21 ms)
    ✓ @Session should return a value from session (10 ms)
    ✓ @Session(param) should allow to inject empty property (2 ms)
    ✓ @QueryParams should give a proper values from request's query parameters (9 ms)
    ✓ @QueryParams should give a proper values from request's query parameters and one multiple value (6 ms)
    ✓ @QueryParams should give a proper values from request's query with validate whitelist option on (12 ms)
    ✓ @QueryParams should give a proper values from request's query parameters with nested json (4 ms)
    ✓ @QueryParams should not validate request query parameters when it's turned off in validator options (3 ms)
    ✓ @QueryParams should give a proper values from request's optional query parameters (2 ms)
    ✓ @QueryParam should give a proper values from request query parameters (2 ms)
    ✓ @QueryParam should give an array of string with only one query parameter (3 ms)
    ✓ @QueryParam should give an array of string with multiple query parameters (3 ms)
    ✓ @QueryParam should give an array of number with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of number with multiple query parameters (2 ms)
    ✓ @QueryParam should give an array of date with only one query parameter (2 ms)
    ✓ @QueryParam should give an array of date with multiple query parameters (2 ms)
    ✓ @QueryParam when required params must be provided and they should not be empty (8 ms)
    ✓ @QueryParam when the type is Date then it should be parsed (1 ms)
    ✓ @QueryParam when the type is Date and it is invalid then the response should be a BadRequest error (3 ms)
    ✓ @QueryParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @HeaderParam should give a proper values from request headers (2 ms)
    ✓ @HeaderParam when required is params must be provided and they should not be empty (2 ms)
    ✓ @HeaderParam should fail with invalid request options (5 ms)
    ✓ @HeaderParam should fail with missing required params (2 ms)
    ✓ for @HeaderParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @CookieParam should give a proper values from request headers (2 ms)
    ✓ @CookieParam when required is params must be provided and they should not be empty (4 ms)
    ✓ @CookieParam when parseJson flag is used query param must be converted to object (2 ms)
    ✓ @Body should provide a request body (12 ms)
    ✓ @Body should fail if required body was not provided (6 ms)
    ✓ @Body should provide a json object for json-typed controllers and actions (2 ms)
    ✓ @Body should fail if required body was not provided for json-typed controllers and actions (8 ms)
    ✓ @BodyParam should provide a json object for json-typed controllers and actions (3 ms)
    ✓ @BodyParam should fail if required body was not provided for json-typed controllers and actions (17 ms)
    ✓ @Body using application/x-www-form-urlencoded should handle url encoded form data (3 ms)
    ✓ @UploadedFile using multipart/form-data should provide uploaded file with the given name (12 ms)
    ✓ @UploadedFile with @Body should return both the file and the body (6 ms)
    ✓ @UploadedFile with @BodyParam should return both the file and the body param (4 ms)
    ✓ @UploadedFile with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFile when required is used files must be provided (6 ms)
    ✓ @UploadedFiles should provide uploaded files with the given name (5 ms)
    ✓ @UploadedFiles with passed uploading options (limit) should throw an error (5 ms)
    ✓ @UploadedFiles when required is used files must be provided (4 ms)

PASS test/functional/load-from-directory.spec.ts
    loading all controllers from the given directories
      ✓ should load all controllers (28 ms)
    loading all express middlewares and error handlers from the given directories
      ✓ should succeed (19 ms)
      ✓ should fail (24 ms)

PASS test/functional/global-options.spec.ts
    routing-controllers global options
      useClassTransformer default value
        ✓ useClassTransformer by default must be set to true (78 ms)
      when useClassTransformer is set to true
        ✓ useClassTransformer is enabled (3 ms)
      when useClassTransformer is set to false
        ✓ useClassTransformer is disabled (3 ms)
      when routePrefix is used all controller routes should be appended by it
        ✓ routePrefix is enabled (6 ms)

PASS test/functional/auth-decorator.spec.ts
    Controller responds with value when Authorization succeeds (async)
      ✓ without roles (54 ms)
      ✓ with roles (13 ms)
      ✓ async (24 ms)
    Controller responds with value when Authorization succeeds (sync)
      ✓ without roles (4 ms)
      ✓ with roles (3 ms)
      ✓ async (13 ms)
    Authorized Decorators Http Status Code
      ✓ without roles (19 ms)
      ✓ with roles (4 ms)
    Authorization checker allows to throw (async)
      ✓ custom errors (17 ms)
    Authorization checker allows to throw (sync)
      ✓ custom errors (3 ms)

PASS test/functional/other-controller-decorators.spec.ts
    other controller decorators
      ✓ should return httpCode set by @HttpCode decorator (25 ms)
      ✓ should return custom code when @OnNull (30 ms)
      ✓ should return custom error message and code when @OnUndefined is used with Error class (9 ms)
      ✓ should return custom code when @OnUndefined (11 ms)
      ✓ should return content-type in the response when @ContentType is used (3 ms)
      ✓ should return content-type in the response when @ContentType is used (2 ms)
      ✓ should return response with custom headers when @Header is used (4 ms)
      ✓ should relocate to new location when @Location is used (3 ms)

PASS test/functional/action-options.spec.ts
    ✓ should use controller options when action transform options are not set (62 ms)
    ✓ should override controller options with action transformRequest option (4 ms)
    ✓ should override controller options with action transformResponse option (3 ms)

PASS test/functional/express-middlewares.spec.ts
    express middlewares
      ✓ should call a global middlewares (30 ms)
      ✓ should use a custom middleware when @UseBefore or @UseAfter is used (13 ms)
      ✓ should call middleware and call it before controller action when @UseBefore is used (4 ms)
      ✓ should call middleware and call it after controller action when @UseAfter is used (13 ms)
      ✓ should call before middleware and call after middleware when @UseAfter and @UseAfter are used (5 ms)
      ✓ should handle errors in custom middlewares (64 ms)

PASS test/functional/express-error-handling.spec.ts
    express error handling
      ✓ should not call global error handler middleware if there was no errors (24 ms)
      ✓ should call global error handler middleware (19 ms)
      ✓ should call global error handler middleware (5 ms)
      ✓ should call error handler middleware if used (4 ms)
      ✓ should not execute next middleware if soft error handled specifically and stopped error bubbling (3 ms)
      ✓ should process JsonErrors by their toJSON method if it exists (2 ms)

PASS test/functional/render-decorator.spec.ts
    template rendering
      ✓ should render a template and use given variables (13 ms)
      ✓ should render a template with given variables and locals variables (4 ms)

PASS test/functional/class-validator-options.spec.ts
    no options
      ✓ should not use any options if not set (51 ms)
    global options
      should merge local validation options with global validation options prioritizing local
        ✓ succeed (5 ms)
      should pass the valid param after validation
        ✓ succeed (4 ms)
        ✓ should contain param name on validation failed (15 ms)
    local options
      ✓ should apply local options (5 ms)

PASS test/functional/container.spec.ts
    using typedi container should be possible
      ✓ typedi container (53 ms)
    using custom container should be possible
      ✓ custom container (5 ms)
    using custom container with fallback should be possible
      ✓ custom container with fallback (9 ms)
    using custom container with fallback and fallback on throw error should be possible
      ✓ custom container with fallback and fallback on throw error (9 ms)

PASS test/functional/controller-options.spec.ts
    controller options
      ✓ controller transform is enabled by default (30 ms)
      ✓ when controller transform is enabled (5 ms)
      ✓ when controller transform is disabled (3 ms)

PASS test/unit/controller-inheritance.spec.ts
  controller inheritance
    ✓ should build empty meta for empty set (11 ms)
    ✓ should build meta if the only derivative controller is given (1 ms)
    ✓ should build meta if the only autonomous controller is given
    ✓ should build meta both when autonomous and derivative controllers are given (1 ms)

PASS test/functional/defaults.spec.ts
    defaults
      ✓ should return undefinedResultCode from defaults config for void function (8 ms)
      ✓ should return undefinedResultCode from defaults config for promise void function (2 ms)
      ✓ should return 400 from required paramOptions (16 ms)
      ✓ should return nullResultCode from defaults config (2 ms)
      ✓ should return status code from OnUndefined annotation (3 ms)
      ✓ should mark arg optional from QueryParam annotation (4 ms)

PASS test/functional/class-transformer-options.spec.ts
    should not use any options if not set
      ✓ technical wrapper (27 ms)
    should apply global options
      ✓ technical wrapper (5 ms)
    should apply local options
      ✓ technical wrapper (4 ms)

PASS test/functional/controller-base-routes.spec.ts
    controller > base routes functionality
      ✓ get should respond with proper status code, headers and body content (51 ms)
      ✓ get should respond with proper status code, headers and body content (4 ms)
      ✓ get should respond with proper status code, headers and body content - 2nd pass (3 ms)
      ✓ wrong route should respond with 404 error (4 ms)
      ✓ wrong route should respond with 404 error (3 ms)
      ✓ wrong route should respond with 404 error (2 ms)

PASS test/functional/express-custom-error-handling.spec.ts
    custom express error handling
      ✓ should not call global error handler middleware if there was no errors (21 ms)
      ✓ should call global error handler middleware (17 ms)

PASS test/functional/express-global-before-error-handling.spec.ts
    custom express global before middleware error handling
      ✓ should call global error handler middleware with CustomError (33 ms)

PASS test/functional/redirect-decorator.spec.ts
    dynamic redirect
      ✓ using template (29 ms)
      ✓ using override (6 ms)
      ✓ using original (5 ms)

PASS test/functional/middlewares-order.spec.ts
    loaded direct from array
      ✓ should call middlewares in order defined by items order (22 ms)
    specified by priority option
      ✓ should call middlewares in order defined by priority parameter of decorator (2 ms)

PASS test/functional/special-result-send.spec.ts
    special result value treatment
      ✓ should pipe stream to response (8 ms)
      ✓ should send raw binary data from Buffer (3 ms)
      ✓ should send raw binary data from UIntArray (16 ms)

PASS test/functional/error-subclasses.spec.ts
  HttpError
    ✓ should be instance of HttpError and Error (3 ms)
  BadRequestError
    ✓ should be instance of BadRequestError, HttpError and Error (2 ms)

Summary of all failing tests
FAIL test/ActionParameterHandler.spec.ts
  ● ActionParameterHandler › negative › handle - throws error if the parameter is required

    Expected value   "TypeError: Cannot read property 'uuid' of undefined"
    Received:
      "TypeError: Cannot read properties of undefined (reading 'uuid')"

    Message:
      expected 'TypeError: Cannot read properties of undefined (reading \'uuid\')' to equal 'TypeError: Cannot read property \'uuid\' of undefined'

    Difference:

    - Expected
    + Received

    - TypeError: Cannot read property 'uuid' of undefined
    + TypeError: Cannot read properties of undefined (reading 'uuid')

      152 |       }
      153 | 
    > 154 |       expect(error.toString()).to.be.eq("TypeError: Cannot read property 'uuid' of undefined");
          |                                      ^
      155 |     });
      156 | 
      157 |     it('handle - throws error if the parameter is required, type file provided', async () => {

      at Object.<anonymous> (test/ActionParameterHandler.spec.ts:154:38)


Test Suites: 1 failed, 25 passed, 26 total
Tests:       1 failed, 181 passed, 182 total
Snapshots:   0 total
Time:        12.607 s, estimated 13 s
Ran all test suites.
